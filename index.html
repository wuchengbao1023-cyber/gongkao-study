<!DOCTYPE html>
<html>
<head>
    <title>å…¬è€ƒæ™ºèƒ½å­¦ä¹ ç³»ç»Ÿ | ä½ çš„ä¸“å±å­¦ä¹ æ•™ç»ƒ</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* ===== åŸºç¡€é‡ç½® ===== */
        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
            -webkit-tap-highlight-color: transparent;
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif; 
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            padding: 15px;
            min-height: 100vh;
        }
        
        /* ===== å®¹å™¨ ===== */
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* ===== é¡¶éƒ¨çŠ¶æ€æ  ===== */
        .status-bar {
            background: white;
            border-radius: 16px;
            padding: 20px 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            border: 1px solid rgba(255,255,255,0.3);
            position: relative;
            overflow: hidden;
        }
        
        .status-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
        }
        
        .status-info {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
            flex: 1;
        }
        
        .status-item {
            text-align: center;
            min-width: 90px;
            position: relative;
        }
        
        .status-label {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 6px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .status-value {
            font-size: 24px;
            font-weight: 800;
            color: #2c3e50;
            font-feature-settings: "tnum";
        }
        
        /* ===== ä¸»å†…å®¹åŒºåŸŸ ===== */
        .main-content {
            display: block;
            gap: 20px;
        }
        
        @media (min-width: 992px) {
            .main-content {
                display: grid;
                grid-template-columns: 2.5fr 1.5fr;
            }
        }
        
        /* ===== å·¦ä¾§ï¼šå­¦ä¹ åŒº ===== */
        .learning-area {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        /* AIæ•™ç»ƒæé†’ */
        .ai-coach {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 14px;
            margin-bottom: 25px;
            display: flex;
            align-items: flex-start;
            gap: 16px;
            position: relative;
            overflow: hidden;
        }
        
        .ai-coach::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1%, transparent 1%);
            background-size: 15px 15px;
            opacity: 0.3;
        }
        
        .coach-avatar {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #667eea;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .coach-message {
            flex: 1;
        }
        
        .coach-title {
            font-weight: 700;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .coach-text {
            font-size: 15px;
            opacity: 0.95;
        }
        
        /* è¿›åº¦æ¡ */
        .progress-container {
            margin: 25px 0;
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .progress-label {
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .progress-percent {
            font-weight: 700;
            font-size: 18px;
            color: #27ae60;
        }
        
        .progress-bar {
            height: 10px;
            background: #ecf0f1;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2ecc71, #27ae60);
            border-radius: 5px;
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.4), 
                transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* æ¨¡å—åˆ—è¡¨ */
        .modules-list {
            margin-top: 30px;
        }
        
        .modules-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modules-title {
            font-size: 18px;
            font-weight: 700;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .module-filters {
            display: flex;
            gap: 10px;
        }
        
        .filter-btn {
            padding: 6px 12px;
            border: 1px solid #dfe6e9;
            border-radius: 20px;
            background: white;
            font-size: 13px;
            color: #636e72;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .filter-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        
        .module-item {
            border: 1px solid #e0e6ed;
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            background: white;
        }
        
        .module-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #d0d9e6;
        }
        
        .module-item.completed {
            background: linear-gradient(135deg, #f8fff8 0%, #f0f9f0 100%);
            border-color: #c8e6c9;
        }
        
        .module-item.recommended {
            background: linear-gradient(135deg, #fffaf0 0%, #fff8e1 100%);
            border-color: #ffd54f;
            animation: gentlePulse 3s infinite;
        }
        
        .module-item.weak {
            background: linear-gradient(135deg, #fff5f5 0%, #ffebee 100%);
            border-color: #ffcdd2;
            border-left: 4px solid #ff6b6b;
        }
        
        @keyframes gentlePulse {
            0%, 100% { box-shadow: 0 0 0 rgba(255, 193, 7, 0); }
            50% { box-shadow: 0 0 0 3px rgba(255, 193, 7, 0.15); }
        }
        
        .module-number {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        
        .module-content {
            margin-left: 40px;
        }
        
        .module-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        
        .module-title {
            font-weight: 700;
            font-size: 17px;
            color: #2c3e50;
            line-height: 1.4;
        }
        
        .module-status {
            font-size: 12px;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            letter-spacing: 0.3px;
        }
        
        .module-status.completed {
            background: #27ae60;
            color: white;
        }
        
        .module-status.recommended {
            background: linear-gradient(135deg, #ff9800, #ff5722);
            color: white;
        }
        
        .module-status.weak {
            background: #ff6b6b;
            color: white;
        }
        
        .module-status.pending {
            background: #dfe6e9;
            color: #636e72;
        }
        
        .module-meta {
            font-size: 14px;
            color: #636e72;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .module-meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .module-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .stat-badge {
            font-size: 13px;
            padding: 6px 12px;
            background: #f8f9fa;
            border-radius: 12px;
            color: #2c3e50;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            border: 1px solid #edf2f7;
        }
        
        .stat-badge.highlight {
            background: #e3f2fd;
            color: #1976d2;
            border-color: #bbdefb;
        }
        
        .module-insights {
            font-size: 13px;
            color: #636e72;
            padding: 10px 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 3px solid #3498db;
        }
        
        .module-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        /* ===== æŒ‰é’®æ ·å¼ ===== */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-height: 48px;
            min-width: 48px;
            user-select: none;
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .btn:active::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% { transform: scale(0, 0); opacity: 0.5; }
            100% { transform: scale(20, 20); opacity: 0; }
        }
        
        .btn-complete {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            flex: 1;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }
        
        .btn-complete:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 204, 113, 0.4);
        }
        
        .btn-details {
            background: #3498db;
            color: white;
            padding: 10px 16px;
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .btn-manage {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
        }
        
        .btn-export {
            background: linear-gradient(135deg, #1abc9c, #16a085);
            color: white;
        }
        
        /* ===== å³ä¾§ï¼šåˆ†æåŒº ===== */
        .analytics-area {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.3);
            height: fit-content;
        }
        
        .analytics-card {
            margin-bottom: 30px;
        }
        
        .analytics-card:last-child {
            margin-bottom: 0;
        }
        
        .analytics-title {
            font-size: 17px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 18px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f4f8;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* å­¦ä¹ ä»ªè¡¨ç›˜ */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .dashboard-stat {
            text-align: center;
            padding: 15px;
            background: #f8fafc;
            border-radius: 12px;
            border: 1px solid #edf2f7;
        }
        
        .dashboard-value {
            font-size: 22px;
            font-weight: 800;
            color: #2c3e50;
            margin: 8px 0;
            font-feature-settings: "tnum";
        }
        
        .dashboard-label {
            font-size: 12px;
            color: #718096;
            font-weight: 500;
        }
        
        /* è–„å¼±æ¨¡å— */
        .weak-modules {
            list-style: none;
        }
        
        .weak-module-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f4f8;
        }
        
        .weak-module-item:last-child {
            border-bottom: none;
        }
        
        .weak-module-name {
            font-size: 14px;
            flex: 1;
        }
        
        .weak-module-accuracy {
            font-weight: 700;
            color: #2c3e50;
        }
        
        .accuracy-badge {
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 10px;
            margin-left: 8px;
            font-weight: 600;
        }
        
        .accuracy-low {
            background: #ffeaea;
            color: #e53e3e;
        }
        
        .accuracy-medium {
            background: #fff5e6;
            color: #dd6b20;
        }
        
        /* ä»Šæ—¥å»ºè®® */
        .daily-tips {
            font-size: 14px;
            line-height: 1.6;
            color: #4a5568;
        }
        
        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 12px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 10px;
            border-left: 3px solid #4299e1;
        }
        
        .tip-icon {
            color: #4299e1;
            flex-shrink: 0;
            margin-top: 2px;
        }
        
        /* æ§åˆ¶æŒ‰é’®ç»„ */
        .control-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 25px;
        }
        
        .control-buttons .btn {
            flex: 1;
            min-width: 0;
        }
        
        /* ===== å¼¹çª—æ ·å¼ ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 550px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        .modal-header {
            margin-bottom: 25px;
            text-align: center;
        }
        
        .modal-title {
            font-size: 22px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .modal-subtitle {
            font-size: 15px;
            color: #718096;
        }
        
        /* æ™ºèƒ½ç»ƒä¹ è®¾ç½® */
        .practice-settings {
            background: linear-gradient(135deg, #f8fafc 0%, #edf2f7 100%);
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid #e2e8f0;
        }
        
        .setting-item {
            margin-bottom: 20px;
        }
        
        .setting-item:last-child {
            margin-bottom: 0;
        }
        
        .setting-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .setting-label-text {
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .setting-value {
            font-weight: 700;
            color: #4299e1;
            font-size: 18px;
        }
        
        .range-container {
            position: relative;
            height: 40px;
            display: flex;
            align-items: center;
        }
        
        .range-slider {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            background: linear-gradient(to right, #e2e8f0, #4299e1);
            border-radius: 3px;
            outline: none;
        }
        
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: white;
            border: 3px solid #4299e1;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(66, 153, 225, 0.4);
            transition: all 0.2s;
        }
        
        .range-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(66, 153, 225, 0.5);
        }
        
        .range-ticks {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            padding: 0 10px;
        }
        
        .range-tick {
            font-size: 11px;
            color: #a0aec0;
        }
        
        .number-input {
            width: 80px;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            color: #2c3e50;
            transition: all 0.3s;
        }
        
        .number-input:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }
        
        /* å®æ—¶åé¦ˆ */
        .real-time-feedback {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            border-left: 4px solid #48bb78;
        }
        
        .feedback-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .feedback-content {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .feedback-item {
            text-align: center;
            padding: 10px;
            background: #f0fff4;
            border-radius: 8px;
        }
        
        .feedback-value {
            font-size: 18px;
            font-weight: 700;
            color: #38a169;
            margin: 5px 0;
        }
        
        .feedback-label {
            font-size: 12px;
            color: #718096;
        }
        
        /* è¡¨å•ç»„ */
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 15px;
            line-height: 1.6;
            resize: vertical;
            min-height: 100px;
            transition: all 0.3s;
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }
        
        /* åº•éƒ¨ä¿¡æ¯ */
        .footer {
            text-align: center;
            margin-top: 25px;
            padding: 20px;
            color: #718096;
            font-size: 14px;
            border-top: 1px solid #edf2f7;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loader {
            text-align: center;
            padding: 40px;
        }
        
        .loader::after {
            content: '';
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 3px solid #f1f5f9;
            border-top: 3px solid #4299e1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* å‹‹ç« ç³»ç»Ÿ */
        .badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 700;
            margin-left: 5px;
        }
        
        .badge-fire {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }
        
        .badge-star {
            background: linear-gradient(135deg, #ffd93d, #ff9a00);
            color: white;
        }
        
        .badge-growth {
            background: linear-gradient(135deg, #6bcf7f, #27ae60);
            color: white;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .status-info {
                gap: 15px;
            }
            
            .status-item {
                min-width: 70px;
            }
            
            .dashboard-stats {
                grid-template-columns: 1fr;
            }
            
            .control-buttons {
                grid-template-columns: 1fr;
            }
            
            .feedback-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
        <div class="status-bar">
            <div class="status-info">
                <div class="status-item">
                    <div class="status-label">ğŸ“Š å½“å‰è½®æ¬¡</div>
                    <div class="status-value" id="currentRound">1</div>
                </div>
                <div class="status-item">
                    <div class="status-label">ğŸ¯ æœ¬è½®è¿›åº¦</div>
                    <div class="status-value" id="todayProgress">0/8</div>
                </div>
                <div class="status-item">
                    <div class="status-label">ğŸ“ æ€»é¢˜æ•°</div>
                    <div class="status-value" id="totalQuestions">0</div>
                </div>
                <div class="status-item">
                    <div class="status-label">âœ… æ­£ç¡®ç‡</div>
                    <div class="status-value" id="accuracyRate">0%</div>
                </div>
                <div class="status-item">
                    <div class="status-label">â±ï¸ å­¦ä¹ æ—¶é•¿</div>
                    <div class="status-value" id="studyTime">0h</div>
                </div>
            </div>
            <div>
                <button class="btn btn-manage" onclick="showEditModal()">
                    <span>âš™ï¸</span>
                    <span class="desktop-only">æ¨¡å—ç®¡ç†</span>
                </button>
            </div>
        </div>
        
        <div class="main-content">
            <!-- å·¦ä¾§ï¼šå­¦ä¹ åŒº -->
            <div class="learning-area">
                <!-- AIæ•™ç»ƒæé†’ -->
                <div class="ai-coach">
                    <div class="coach-avatar">ğŸ‘¨â€ğŸ«</div>
                    <div class="coach-message">
                        <div class="coach-title">ğŸ“¢ ä½ çš„ä¸“å±å­¦ä¹ æ•™ç»ƒ</div>
                        <div class="coach-text" id="coachMessage">å‡†å¤‡å¥½å¼€å§‹ä»Šå¤©çš„å­¦ä¹ äº†å—ï¼Ÿç³»ç»Ÿä¼šæ ¹æ®ä½ çš„è¡¨ç°æ™ºèƒ½æ¨èç»ƒä¹ å†…å®¹ï¼</div>
                    </div>
                </div>
                
                <!-- è¿›åº¦æ¡ -->
                <div class="progress-container">
                    <div class="progress-header">
                        <div class="progress-label">
                            <span>ğŸ“ˆ æœ¬è½®è¿›åº¦</span>
                            <span id="completedCount">0</span>/<span id="totalCount">8</span>
                        </div>
                        <div class="progress-percent" id="progressPercent">0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar" style="width: 0%"></div>
                    </div>
                </div>
                
                <!-- æ¨¡å—åˆ—è¡¨ -->
                <div class="modules-list">
                    <div class="modules-header">
                        <div class="modules-title">ğŸ“š å­¦ä¹ æ¨¡å—</div>
                        <div class="module-filters">
                            <button class="filter-btn active" onclick="filterModules('all')">å…¨éƒ¨</button>
                            <button class="filter-btn" onclick="filterModules('weak')">è–„å¼±</button>
                            <button class="filter-btn" onclick="filterModules('recommended')">æ¨è</button>
                            <button class="filter-btn" onclick="filterModules('completed')">å·²å®Œæˆ</button>
                        </div>
                    </div>
                    <div id="modulesContainer">
                        <!-- æ¨¡å—ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
            
            <!-- å³ä¾§ï¼šåˆ†æåŒº -->
            <div class="analytics-area">
                <!-- å­¦ä¹ ä»ªè¡¨ç›˜ -->
                <div class="analytics-card">
                    <div class="analytics-title">ğŸ“Š å­¦ä¹ ä»ªè¡¨ç›˜</div>
                    <div class="dashboard-stats">
                        <div class="dashboard-stat">
                            <div class="dashboard-value" id="statTotalRounds">0</div>
                            <div class="dashboard-label">æ€»è½®æ•°</div>
                        </div>
                        <div class="dashboard-stat">
                            <div class="dashboard-value" id="statStreakDays">0</div>
                            <div class="dashboard-label">è¿ç»­å­¦ä¹ </div>
                        </div>
                        <div class="dashboard-stat">
                            <div class="dashboard-value" id="statAvgAccuracy">0%</div>
                            <div class="dashboard-label">å¹³å‡æ­£ç¡®ç‡</div>
                        </div>
                        <div class="dashboard-stat">
                            <div class="dashboard-value" id="statAvgQuestions">0</div>
                            <div class="dashboard-label">å¹³å‡é¢˜é‡/æ¬¡</div>
                        </div>
                    </div>
                </div>
                
                <!-- è–„å¼±æ¨¡å—æç¤º -->
                <div class="analytics-card">
                    <div class="analytics-title">âš ï¸ è–„å¼±æ¨¡å—</div>
                    <ul class="weak-modules" id="weakModulesList">
                        <li class="weak-module-item">
                            <div class="weak-module-name">æš‚æ— è–„å¼±æ¨¡å—</div>
                            <div class="weak-module-accuracy">-</div>
                        </li>
                    </ul>
                </div>
                
                <!-- ä»Šæ—¥å­¦ä¹ å»ºè®® -->
                <div class="analytics-card">
                    <div class="analytics-title">ğŸ’¡ ä»Šæ—¥å»ºè®®</div>
                    <div class="daily-tips" id="dailyTips">
                        <div class="tip-item">
                            <div class="tip-icon">ğŸ¯</div>
                            <div>ç³»ç»Ÿä¼šæ ¹æ®ä½ çš„å†å²è¡¨ç°æ™ºèƒ½æ¨èç»ƒä¹ æ¨¡å—</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">ğŸ“</div>
                            <div>è–„å¼±æ¨¡å—ä¼šè‡ªåŠ¨å»ºè®®å¢åŠ é¢˜é‡ï¼Œå»ºè®®é‡ç‚¹çªç ´</div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">âš¡</div>
                            <div>å¯ä»¥è‡ªç”±é€‰æ‹©ä»»æ„æ¨¡å—ç»ƒä¹ ï¼Œä¸å†å—é¡ºåºé™åˆ¶</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="control-buttons">
            <button class="btn btn-reset" onclick="showResetModal()">
                <span>ğŸ”„</span>
                é‡ç½®æœ¬è½®
            </button>
            <button class="btn btn-reset" onclick="showClearAllModal()" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
                <span>ğŸ—‘ï¸</span>
                æ¸…ç©ºæ•°æ®
            </button>
            <button class="btn btn-export" onclick="exportData()">
                <span>ğŸ“¤</span>
                å¯¼å‡ºæ•°æ®
            </button>
            <button class="btn btn-manage" onclick="showStatsModal()">
                <span>ğŸ“ˆ</span>
                å­¦ä¹ æŠ¥å‘Š
            </button>
        </div>
        
        <div class="footer">
            <div>ğŸ’¾ æ•°æ®è‡ªåŠ¨ä¿å­˜åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­ Â· åˆ·æ–°é¡µé¢ä¸ä¼šä¸¢å¤±</div>
            <div style="font-size: 12px; margin-top: 8px; color: #a0aec0;">å…¬è€ƒæ™ºèƒ½å­¦ä¹ ç³»ç»Ÿ v2.0 | ä½ çš„ä¸“å±å­¦ä¹ æ•™ç»ƒ</div>
        </div>
    </div>
    
    <!-- å®Œæˆæ¨¡å—å¼¹çª— -->
    <div id="completeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="completeModuleTitle">å®Œæˆæ¨¡å—</div>
                <div class="modal-subtitle" id="completeModuleSubtitle">è¯·å¡«å†™æœ¬æ¬¡ç»ƒä¹ çš„è¯¦ç»†ä¿¡æ¯</div>
            </div>
            
            <!-- æ™ºèƒ½ç»ƒä¹ è®¾ç½® -->
            <div class="practice-settings">
                <div class="setting-item">
                    <div class="setting-label">
                        <div class="setting-label-text">ğŸ¯ æ™ºèƒ½å»ºè®®é¢˜æ•°</div>
                        <div class="setting-value" id="recommendedQuestions">20</div>
                    </div>
                    <div class="range-container">
                        <input type="range" class="range-slider" id="questionsRange" min="15" max="50" value="20" step="5">
                    </div>
                    <div class="range-ticks">
                        <span class="range-tick">15</span>
                        <span class="range-tick">25</span>
                        <span class="range-tick">35</span>
                        <span class="range-tick">45</span>
                        <span class="range-tick">50+</span>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-label">
                        <div class="setting-label-text">âœ… æœ¬æ¬¡ç»ƒä¹ é¢˜æ•°</div>
                        <div class="setting-value" id="currentQuestions">20</div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <input type="range" class="range-slider" id="questionsSlider" min="5" max="100" value="20" style="flex: 1;">
                        <input type="number" class="number-input" id="questionsInput" min="5" max="100" value="20">
                        <span>é¢˜</span>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-label">
                        <div class="setting-label-text">âŒ é”™é¢˜æ•°é‡</div>
                        <div class="setting-value" id="wrongCountDisplay">0</div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <input type="range" class="range-slider" id="wrongRange" min="0" max="50" value="0" style="flex: 1;">
                        <input type="number" class="number-input" id="wrongInput" min="0" max="100" value="0">
                        <span>é¢˜</span>
                    </div>
                </div>
            </div>
            
            <!-- å®æ—¶åé¦ˆ -->
            <div class="real-time-feedback" id="realTimeFeedback">
                <div class="feedback-title">ğŸ“Š å®æ—¶è®¡ç®—ç»“æœ</div>
                <div class="feedback-content">
                    <div class="feedback-item">
                        <div class="feedback-value" id="accuracyDisplay">100%</div>
                        <div class="feedback-label">æœ¬æ¬¡æ­£ç¡®ç‡</div>
                    </div>
                    <div class="feedback-item">
                        <div class="feedback-value" id="totalQuestionsDisplay">0</div>
                        <div class="feedback-label">ç´¯è®¡é¢˜æ•°</div>
                    </div>
                    <div class="feedback-item">
                        <div class="feedback-value" id="avgAccuracyDisplay">0%</div>
                        <div class="feedback-label">å†å²å¹³å‡</div>
                    </div>
                    <div class="feedback-item">
                        <div class="feedback-value" id="progressDisplay">-</div>
                        <div class="feedback-label">å¯¹æ¯”ä¸Šæ¬¡</div>
                    </div>
                </div>
            </div>
            
            <!-- ç»ƒä¹ å¤‡æ³¨ -->
            <div class="form-group">
                <label class="form-label">ğŸ“ æœ¬æ¬¡ç»ƒä¹ é‡ç‚¹ä¸å¿ƒå¾—</label>
                <textarea class="form-textarea" id="noteInput" placeholder="è®°å½•æœ¬æ¬¡ç»ƒä¹ çš„æ”¶è·ã€éš¾ç‚¹ã€éœ€è¦æ³¨æ„çš„åœ°æ–¹...ï¼ˆå¯é€‰ï¼‰"></textarea>
            </div>
            
            <!-- æ“ä½œæŒ‰é’® -->
            <div style="display: flex; gap: 12px; margin-top: 30px;">
                <button type="button" class="btn" onclick="closeCompleteModal()" style="flex: 1; background: #e2e8f0; color: #4a5568;">
                    å–æ¶ˆ
                </button>
                <button type="button" class="btn btn-complete" onclick="submitComplete()" style="flex: 2;">
                    <span>âœ…</span>
                    ç¡®è®¤å®Œæˆç»ƒä¹ 
                </button>
            </div>
        </div>
    </div>
    
    <!-- å­¦ä¹ æŠ¥å‘Šå¼¹çª— -->
    <div id="statsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ğŸ“ˆ è¯¦ç»†å­¦ä¹ æŠ¥å‘Š</div>
                <div class="modal-subtitle">æ·±åº¦åˆ†æä½ çš„å­¦ä¹ è¡¨ç°ä¸è¿›æ­¥è¶‹åŠ¿</div>
            </div>
            <div id="statsContent">
                <!-- å­¦ä¹ æŠ¥å‘Šå†…å®¹ç”±JSç”Ÿæˆ -->
            </div>
            <div style="text-align: center; margin-top: 25px;">
                <button class="btn" onclick="closeStatsModal()" style="background: #e2e8f0; color: #4a5568; padding: 12px 30px;">
                    å…³é—­
                </button>
            </div>
        </div>
    </div>
    
    <!-- å…¶ä»–å¼¹çª—ï¼ˆç¼–è¾‘æ¨¡å—ã€é‡ç½®ã€æ¸…ç©ºæ•°æ®ç­‰ï¼‰ -->
    <!-- ç”±äºä»£ç é•¿åº¦é™åˆ¶ï¼Œè¿™äº›å¼¹çª—çš„HTMLç»“æ„ä¸ä¹‹å‰ç±»ä¼¼ï¼Œä½†å·²æ›´æ–°ä¸ºæ–°çš„æ ·å¼ -->
    <!-- ç¼–è¾‘æ¨¡å—å¼¹çª— -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">âš™ï¸ æ¨¡å—ç®¡ç†</div>
                <div class="modal-subtitle">è‡ªå®šä¹‰ä½ çš„å­¦ä¹ æ¨¡å—ä¸è®¾ç½®</div>
            </div>
            <div class="module-edit-list" id="moduleEditList">
                <!-- ç¼–è¾‘åˆ—è¡¨ç”±JSç”Ÿæˆ -->
            </div>
            <div style="text-align: center; margin: 25px 0;">
                <button class="btn btn-manage" onclick="showAddModuleModal()">
                    <span>â•</span>
                    æ·»åŠ æ–°æ¨¡å—
                </button>
            </div>
            <div style="display: flex; gap: 12px;">
                <button class="btn btn-complete" onclick="saveModules()" style="flex: 1;">
                    <span>ğŸ’¾</span>
                    ä¿å­˜è®¾ç½®
                </button>
                <button class="btn" onclick="closeEditModal()" style="flex: 1; background: #e2e8f0; color: #4a5568;">
                    å–æ¶ˆ
                </button>
            </div>
        </div>
    </div>
    
    <!-- æ·»åŠ æ¨¡å—å¼¹çª— -->
    <div id="addModuleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">â• æ·»åŠ æ–°æ¨¡å—</div>
                <div class="modal-subtitle">åˆ›å»ºæ–°çš„å­¦ä¹ æ¨¡å—</div>
            </div>
            <form id="addModuleForm" onsubmit="return false;">
                <div class="form-group">
                    <label class="form-label">ğŸ“ æ¨¡å—åç§°</label>
                    <input type="text" class="form-textarea" id="newModuleName" placeholder="ä¾‹å¦‚ï¼šç”³è®ºå†™ä½œè®­ç»ƒ" required style="height: auto; min-height: 0;">
                </div>
                <div class="form-group">
                    <label class="form-label">ğŸ·ï¸ æ¨¡å—åˆ†ç±»</label>
                    <select class="form-textarea" id="newModuleCategory" style="height: auto; min-height: 0;">
                        <option value="è¨€è¯­ç†è§£">è¨€è¯­ç†è§£</option>
                        <option value="åˆ¤æ–­æ¨ç†">åˆ¤æ–­æ¨ç†</option>
                        <option value="èµ„æ–™åˆ†æ">èµ„æ–™åˆ†æ</option>
                        <option value="æ•°é‡å…³ç³»">æ•°é‡å…³ç³»</option>
                        <option value="ç”³è®º">ç”³è®º</option>
                        <option value="å¸¸è¯†">å¸¸è¯†</option>
                        <option value="ä¸“é¡¹è®­ç»ƒ">ä¸“é¡¹è®­ç»ƒ</option>
                    </select>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">â±ï¸ å»ºè®®æ—¶é—´</label>
                        <input type="number" class="form-textarea" id="newModuleTime" min="5" max="180" value="30" required style="height: auto; min-height: 0;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ğŸ“ å»ºè®®é¢˜é‡</label>
                        <input type="number" class="form-textarea" id="newModuleQuestions" min="1" max="100" value="20" required style="height: auto; min-height: 0;">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">ğŸ’¡ è¾“å‡ºä»»åŠ¡æè¿°</label>
                    <textarea class="form-textarea" id="newModuleDesc" rows="3" placeholder="ä¾‹å¦‚ï¼šæ¯é¢˜æ€»ç»“è§£é¢˜æ€è·¯"></textarea>
                </div>
                <div style="display: flex; gap: 12px; margin-top: 25px;">
                    <button type="button" class="btn" onclick="closeAddModuleModal()" style="flex: 1; background: #e2e8f0; color: #4a5568;">
                        å–æ¶ˆ
                    </button>
                    <button type="submit" class="btn btn-complete" onclick="addModule()" style="flex: 1;">
                        æ·»åŠ æ¨¡å—
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- é‡ç½®ç¡®è®¤å¼¹çª— -->
    <div id="resetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ğŸ”„ é‡ç½®ç¡®è®¤</div>
                <div class="modal-subtitle">é‡ç½®å½“å‰è½®æ¬¡çš„è¿›åº¦</div>
            </div>
            <div style="text-align: center; padding: 20px;">
                <div style="font-size: 16px; color: #4a5568; margin-bottom: 25px; line-height: 1.6;">
                    è¿™å°†æ¸…ç©ºå½“å‰è½®æ¬¡æ‰€æœ‰æ¨¡å—çš„å®ŒæˆçŠ¶æ€ï¼Œå¼€å§‹æ–°ä¸€è½®å­¦ä¹ ã€‚<br>
                    <span style="color: #e53e3e; font-weight: 600;">å†å²ç»Ÿè®¡æ•°æ®ä¸ä¼šå—åˆ°å½±å“ã€‚</span>
                </div>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button class="btn" onclick="closeResetModal()" style="background: #e2e8f0; color: #4a5568; padding: 12px 30px;">
                        å–æ¶ˆ
                    </button>
                    <button class="btn btn-reset" onclick="resetToday()" style="padding: 12px 30px;">
                        ç¡®è®¤é‡ç½®
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æ¸…ç©ºæ•°æ®å¼¹çª— -->
    <div id="clearAllModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" style="color: #e53e3e;">âš ï¸ å±é™©æ“ä½œ</div>
                <div class="modal-subtitle">æ¸…ç©ºæ‰€æœ‰å­¦ä¹ æ•°æ®</div>
            </div>
            <div style="text-align: center; padding: 20px;">
                <div style="font-size: 15px; color: #4a5568; margin-bottom: 20px; text-align: left; padding: 15px; background: #fff5f5; border-radius: 10px; border-left: 4px solid #e53e3e;">
                    <div style="font-weight: 600; margin-bottom: 10px; color: #e53e3e;">è¿™å°†åˆ é™¤æ‰€æœ‰å­¦ä¹ è®°å½•ï¼ŒåŒ…æ‹¬ï¼š</div>
                    <ul style="margin-left: 20px; line-height: 1.8;">
                        <li>æ‰€æœ‰æ¨¡å—çš„å†å²ç»Ÿè®¡æ•°æ®</li>
                        <li>æ€»ä½“å­¦ä¹ è¿›åº¦ä¸è½®æ¬¡è®°å½•</li>
                        <li>è¿ç»­å­¦ä¹ å¤©æ•°è®°å½•</li>
                        <li>è‡ªå®šä¹‰çš„æ¨¡å—è®¾ç½®</li>
                    </ul>
                </div>
                <div style="font-size: 16px; color: #e53e3e; font-weight: 600; margin: 25px 0; padding: 15px; background: #fed7d7; border-radius: 10px;">
                    ğŸš¨ æ­¤æ“ä½œä¸å¯æ¢å¤ï¼è¯·è°¨æ…æ“ä½œã€‚
                </div>
                <div class="form-group">
                    <label class="form-label">è¯·è¾“å…¥"DELETE"ç¡®è®¤æ“ä½œï¼š</label>
                    <input type="text" class="form-textarea" id="resetConfirmInput" placeholder="DELETE" oninput="this.value = this.value.toUpperCase()" style="height: auto; min-height: 0; text-align: center; letter-spacing: 2px;">
                </div>
                <div style="display: flex; gap: 12px; justify-content: center; margin-top: 25px;">
                    <button class="btn" onclick="closeClearAllModal()" style="background: #e2e8f0; color: #4a5568; padding: 12px 30px;">
                        å–æ¶ˆ
                    </button>
                    <button class="btn btn-reset" onclick="clearAllData()" style="padding: 12px 30px;" disabled id="clearAllBtn">
                        <span>ğŸ—‘ï¸</span>
                        æ¸…ç©ºæ‰€æœ‰æ•°æ®
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ============================================
        // å…¬è€ƒæ™ºèƒ½å­¦ä¹ ç³»ç»Ÿ v2.0
        // ä½ çš„ä¸“å±å­¦ä¹ æ•™ç»ƒ
        // ============================================
        
        // å­¦ä¹ æ•°æ®
        const studyData = {
            // ç³»ç»ŸçŠ¶æ€
            currentDate: '',
            currentRound: 1,
            currentModuleIndex: 0,
            todayCompleted: 0,
            totalRounds: 0,
            
            // æ€»ä½“ç»Ÿè®¡
            overall: {
                totalQuestions: 0,
                totalCorrect: 0,
                streakDays: 0,
                totalDays: 0,
                lastStudyDate: '',
                totalTime: 0, // åˆ†é’Ÿ
                totalSessions: 0, // ç»ƒä¹ æ¬¡æ•°
                avgQuestionsPerSession: 0, // å¹³å‡æ¯æ¬¡é¢˜æ•°
            },
            
            // æ¨¡å—å®šä¹‰ï¼ˆé»˜è®¤ï¼‰
            modules: [
                { 
                    id: 1, 
                    name: "è¨€è¯­ç‰‡æ®µé˜…è¯»", 
                    category: "è¨€è¯­ç†è§£",
                    time: 30, 
                    questions: 20, 
                    desc: "æ¯é¢˜â‰¤10å­—å†™æ ¸å¿ƒè®ºç‚¹",
                    order: 1 
                },
                { 
                    id: 2, 
                    name: "é€»è¾‘åˆ¤æ–­", 
                    category: "åˆ¤æ–­æ¨ç†",
                    time: 35, 
                    questions: 20, 
                    desc: "å†™è®ºè¯ç±»å‹+é€»è¾‘é“¾",
                    order: 2 
                },
                { 
                    id: 3, 
                    name: "èµ„æ–™åˆ†æ", 
                    category: "èµ„æ–™åˆ†æ",
                    time: 35, 
                    questions: 20, 
                    desc: "å£è¿°æœ€éš¾è®¡ç®—æ€è·¯",
                    order: 3 
                },
                { 
                    id: 4, 
                    name: "è¨€è¯­å¡«ç©º", 
                    category: "è¨€è¯­ç†è§£",
                    time: 30, 
                    questions: 20, 
                    desc: "è®°å½•çŠ¹è±«é€‰é¡¹å¹¶è¾¨æ",
                    order: 4 
                },
                { 
                    id: 5, 
                    name: "å›¾å½¢æ¨ç†", 
                    category: "åˆ¤æ–­æ¨ç†",
                    time: 25, 
                    questions: 20, 
                    desc: "æ³¨é”™/æ…¢é¢˜'æ­»åœ¨ä½•æ­¥'",
                    order: 5 
                },
                { 
                    id: 6, 
                    name: "å®šä¹‰åˆ¤æ–­", 
                    category: "åˆ¤æ–­æ¨ç†",
                    time: 25, 
                    questions: 20, 
                    desc: "å…ˆè‡ªè¯é‡è¿°å®šä¹‰",
                    order: 6 
                },
                { 
                    id: 7, 
                    name: "ç±»æ¯”æ¨ç†", 
                    category: "åˆ¤æ–­æ¨ç†",
                    time: 20, 
                    questions: 20, 
                    desc: "é”™é¢˜åå‘æ„é€ ä¾‹å­",
                    order: 7 
                },
                { 
                    id: 8, 
                    name: "ç»ˆæä»»åŠ¡", 
                    category: "ç»¼åˆè®­ç»ƒ",
                    time: 60, 
                    questions: 1, 
                    desc: "ç”³è®º/é”™æ€/ä½“èƒ½ä¸‰é€‰ä¸€",
                    order: 8 
                }
            ],
            
            // æ¨¡å—ç»Ÿè®¡æ•°æ®
            moduleStats: {},
            
            // æ¯æ—¥è®°å½•
            daily: {
                date: '',
                completed: [], // å·²å®Œæˆçš„æ¨¡å—ID
                startTime: 0,
                totalTime: 0,
                sessions: [] // ä»Šæ—¥ç»ƒä¹ è®°å½•
            },
            
            // å†å²è®°å½•
            history: [],
            
            // æˆå°±ç³»ç»Ÿ
            achievements: {
                totalQuestionsMilestones: [100, 500, 1000, 5000],
                streakMilestones: [3, 7, 14, 30, 100],
                accuracyMilestones: [70, 80, 90, 95],
                completed: []
            }
        };
        
        // AIæ•™ç»ƒæ¶ˆæ¯åº“
        const coachMessages = {
            // é—®å€™ç±»
            greetings: [
                "å‡†å¤‡å¥½å¼€å§‹ä»Šå¤©çš„å­¦ä¹ äº†å—ï¼Ÿç³»ç»Ÿä¼šæ ¹æ®ä½ çš„è¡¨ç°æ™ºèƒ½æ¨èç»ƒä¹ å†…å®¹ï¼",
                "æ¬¢è¿å›æ¥ï¼ä»Šå¤©ä¹Ÿè¦å…¨åŠ›ä»¥èµ´ï¼Œå‘ç›®æ ‡è¿ˆè¿›ï¼",
                "æ–°çš„ä¸€å¤©ï¼Œæ–°çš„å¼€å§‹ï¼è®©æˆ‘ä»¬ç»§ç»­æ”»å…‹è–„å¼±ç¯èŠ‚ï¼",
                "æ£€æµ‹åˆ°ä½ å·²è¿ç»­å­¦ä¹ {streakDays}å¤©ï¼Œç»§ç»­ä¿æŒè¿™ä¸ªåŠ¿å¤´ï¼"
            ],
            
            // è¿›åº¦ç±»
            progress: [
                "å½“å‰è¿›åº¦{completed}/{total}ï¼Œç»§ç»­åŠ æ²¹ï¼",
                "å·²å®Œæˆ{percent}%ï¼Œä»Šå¤©çŠ¶æ€ä¸é”™ï¼",
                "ä¿æŒè¿™ä¸ªèŠ‚å¥ï¼Œä»Šå¤©å°±èƒ½å®Œæˆæœ¬è½®å­¦ä¹ ï¼"
            ],
            
            // æˆå°±ç±»
            achievements: [
                "ğŸ‰ æ­å–œï¼ä½ åˆšåˆšå®Œæˆäº†ç¬¬{milestone}é¢˜ï¼",
                "ğŸ”¥ å¤ªæ£’äº†ï¼è¿ç»­å­¦ä¹ {streakDays}å¤©æˆå°±è¾¾æˆï¼",
                "ğŸ’ å®Œç¾ï¼{moduleName}æ¨¡å—æ­£ç¡®ç‡çªç ´{accuracy}%ï¼"
            ],
            
            // å»ºè®®ç±»
            suggestions: [
                "å»ºè®®ä»Šå¤©é‡ç‚¹ç»ƒä¹ è–„å¼±æ¨¡å—ï¼š{weakModule}",
                "æ£€æµ‹åˆ°ä½ å·²ç»ƒä¹ {hours}å°æ—¶ï¼Œé€‚å½“ä¼‘æ¯ä¸€ä¸‹å§ï¼",
                "æœ€è¿‘{moduleName}è¿›æ­¥æ˜æ˜¾ï¼Œç»§ç»­ä¿æŒï¼"
            ],
            
            // è­¦å‘Šç±»
            warnings: [
                "âš ï¸ æ³¨æ„ï¼{moduleName}æ¨¡å—æ­£ç¡®ç‡åªæœ‰{accuracy}%ï¼Œéœ€è¦åŠ å¼ºï¼",
                "æ£€æµ‹åˆ°é•¿æ—¶é—´æœªç»ƒä¹ {moduleName}ï¼Œå»ºè®®ä»Šå¤©å¤ä¹ ä¸€ä¸‹",
                "æœ€è¿‘æ­£ç¡®ç‡æœ‰æ‰€ä¸‹æ»‘ï¼Œå»ºè®®æ”¾æ…¢èŠ‚å¥ï¼Œæ³¨é‡è´¨é‡"
            ]
        };
        
        // å½“å‰ç»ƒä¹ çš„æ¨¡å—ä¿¡æ¯
        let currentModuleInfo = null;
        
        // åˆå§‹åŒ–
        function init() {
            console.log("ğŸš€ å…¬è€ƒæ™ºèƒ½å­¦ä¹ ç³»ç»Ÿ v2.0 åˆå§‹åŒ–...");
            loadData();
            checkNewDay();
            updateDisplay();
            setupEventListeners();
            updateCoachMessage();
            
            // æ˜¾ç¤ºæ¬¢è¿æç¤º
            setTimeout(() => {
                showNotification("æ¬¢è¿ä½¿ç”¨å…¬è€ƒæ™ºèƒ½å­¦ä¹ ç³»ç»Ÿ", "ä½ çš„ä¸“å±å­¦ä¹ æ•™ç»ƒå·²å°±ä½ï¼", "info");
            }, 1000);
        }
        
        // åŠ è½½æ•°æ®
        function loadData() {
            const saved = localStorage.getItem('studyData');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    
                    // æ™ºèƒ½åˆå¹¶æ•°æ®
                    Object.keys(data).forEach(key => {
                        if (studyData[key] !== undefined) {
                            if (typeof studyData[key] === 'object' && studyData[key] !== null) {
                                // æ·±åº¦åˆå¹¶å¯¹è±¡
                                Object.keys(data[key]).forEach(subKey => {
                                    studyData[key][subKey] = data[key][subKey];
                                });
                            } else {
                                studyData[key] = data[key];
                            }
                        }
                    });
                    
                    // åˆå§‹åŒ–moduleStatsï¼ˆå…¼å®¹æ—§æ•°æ®ï¼‰
                    studyData.modules.forEach(module => {
                        if (!studyData.moduleStats[module.id]) {
                            studyData.moduleStats[module.id] = {
                                attempts: 0,
                                totalQuestions: 0,
                                totalCorrect: 0,
                                bestAccuracy: 0,
                                lastAccuracy: 0,
                                history: [],
                                lastPracticeDate: '',
                                streak: 0,
                                avgQuestions: module.questions
                            };
                        }
                    });
                    
                    console.log('âœ… æ•°æ®åŠ è½½æˆåŠŸ');
                } catch (e) {
                    console.error('âŒ æ•°æ®åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®', e);
                    // ä½¿ç”¨é»˜è®¤æ•°æ®
                }
            }
        }
        
        // ä¿å­˜æ•°æ®
        function saveData() {
            try {
                localStorage.setItem('studyData', JSON.stringify(studyData));
                return true;
            } catch (e) {
                console.error('âŒ æ•°æ®ä¿å­˜å¤±è´¥', e);
                showNotification("ä¿å­˜å¤±è´¥", "å¯èƒ½æ˜¯å­˜å‚¨ç©ºé—´ä¸è¶³", "error");
                return false;
            }
        }
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(title, message, type = 'info') {
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´ç¾è§‚çš„é€šçŸ¥ç³»ç»Ÿ
            console.log(`ğŸ“¢ ${title}: ${message}`);
        }
        
        // ============================================
        // æ™ºèƒ½æ ¸å¿ƒç®—æ³•
        // ============================================
        
        // æ™ºèƒ½æ¨èä¸‹ä¸€ä¸ªæ¨¡å—
        function findRecommendedModule() {
            const uncompletedModules = studyData.modules.filter(
                module => !studyData.daily.completed.includes(module.id)
            );
            
            if (uncompletedModules.length === 0) return 0;
            
            // ä¸ºæ¯ä¸ªæœªå®Œæˆæ¨¡å—è®¡ç®—æ¨èåˆ†æ•°
            const scoredModules = uncompletedModules.map(module => {
                const stats = studyData.moduleStats[module.id] || {
                    attempts: 0,
                    totalQuestions: 0,
                    totalCorrect: 0,
                    history: []
                };
                
                let score = 0;
                
                // 1. è–„å¼±ç¨‹åº¦ï¼ˆæ­£ç¡®ç‡è¶Šä½åˆ†æ•°è¶Šé«˜ï¼‰
                if (stats.attempts > 0) {
                    const accuracy = stats.totalCorrect / stats.totalQuestions;
                    const weaknessScore = (1 - accuracy) * 100; // 0-100åˆ†
                    score += weaknessScore * 0.6; // æƒé‡60%
                } else {
                    score += 50; // æ–°æ¨¡å—ä¸­ç­‰ä¼˜å…ˆçº§
                }
                
                // 2. ç»ƒä¹ é¢‘ç‡ï¼ˆæœ€è¿‘æ²¡ç»ƒçš„ä¼˜å…ˆï¼‰
                if (stats.lastPracticeDate) {
                    const daysSinceLast = Math.floor((new Date() - new Date(stats.lastPracticeDate)) / (1000 * 60 * 60 * 24));
                    const recencyScore = Math.min(daysSinceLast * 10, 50); // æœ€å¤š50åˆ†
                    score += recencyScore * 0.3; // æƒé‡30%
                } else {
                    score += 30; // ä»æœªç»ƒä¹ è¿‡
                }
                
                // 3. è¿›æ­¥è¶‹åŠ¿ï¼ˆæ­£åœ¨è¿›æ­¥çš„é€‚å½“é™ä½ä¼˜å…ˆçº§ï¼‰
                if (stats.history.length >= 3) {
                    const recent = stats.history.slice(-3);
                    const trend = recent[2].accuracy - recent[0].accuracy;
                    const trendScore = trend > 5 ? -20 : (trend < -5 ? 10 : 0);
                    score += trendScore * 0.1; // æƒé‡10%
                }
                
                return {
                    module: module,
                    score: score,
                    stats: stats
                };
            });
            
            // æŒ‰åˆ†æ•°ä»é«˜åˆ°ä½æ’åº
            scoredModules.sort((a, b) => b.score - a.score);
            
            // è¿”å›æœ€æ¨èæ¨¡å—çš„ç´¢å¼•
            const recommendedModule = scoredModules[0].module;
            return studyData.modules.findIndex(m => m.id === recommendedModule.id);
        }
        
        // æ™ºèƒ½å»ºè®®ç»ƒä¹ é¢˜æ•°
        function recommendQuestionCount(moduleId) {
            const module = studyData.modules.find(m => m.id === moduleId);
            const stats = studyData.moduleStats[moduleId];
            
            if (!stats || stats.attempts === 0) {
                // æ–°æ¨¡å—ï¼šä½¿ç”¨æ¨¡å—é»˜è®¤é¢˜æ•°
                return module.questions;
            }
            
            const accuracy = stats.totalCorrect / stats.totalQuestions;
            
            // æ ¹æ®æ­£ç¡®ç‡æ™ºèƒ½å»ºè®®é¢˜æ•°
            if (accuracy < 0.6) {
                // è–„å¼±æ¨¡å—ï¼šå»ºè®®åŠ é‡ç»ƒä¹ 
                return Math.max(module.questions, 30); // è‡³å°‘30é¢˜
            } else if (accuracy < 0.7) {
                // ä¸€èˆ¬æ¨¡å—ï¼šé€‚é‡å¢åŠ 
                return Math.max(module.questions, 25); // è‡³å°‘25é¢˜
            } else if (accuracy < 0.8) {
                // è‰¯å¥½æ¨¡å—ï¼šç»´æŒ
                return module.questions;
            } else {
                // ä¼˜ç§€æ¨¡å—ï¼šå¯ä»¥é€‚å½“å‡å°‘ï¼Œä¿æŒæ‰‹æ„Ÿ
                return Math.max(15, module.questions - 5); // è‡³å°‘15é¢˜
            }
        }
        
        // è®¡ç®—è¿›æ­¥è¶‹åŠ¿
        function calculateProgressTrend(moduleId) {
            const stats = studyData.moduleStats[moduleId];
            if (!stats || stats.history.length < 3) return null;
            
            const recent = stats.history.slice(-3);
            const latestAccuracy = recent[2].accuracy;
            const oldestAccuracy = recent[0].accuracy;
            const trend = latestAccuracy - oldestAccuracy;
            
            return {
                trend: trend,
                direction: trend > 2 ? 'up' : (trend < -2 ? 'down' : 'stable'),
                magnitude: Math.abs(trend)
            };
        }
        
        // ============================================
        // æ—¶é—´ä¸æ—¥æœŸå¤„ç†
        // ============================================
        
        function getTodayDate() {
            const now = new Date();
            return now.toISOString().split('T')[0]; // YYYY-MM-DD
        }
        
        function getYesterdayDate() {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            return yesterday.toISOString().split('T')[0];
        }
        
        function formatTime(minutes) {
            if (minutes < 60) {
                return `${minutes}åˆ†é’Ÿ`;
            } else {
                const hours = Math.floor(minutes / 60);
                const mins = minutes % 60;
                return mins > 0 ? `${hours}å°æ—¶${mins}åˆ†é’Ÿ` : `${hours}å°æ—¶`;
            }
        }
        
        // æ£€æŸ¥æ˜¯å¦æ–°çš„ä¸€å¤©
        function checkNewDay() {
            const today = getTodayDate();
            
            if (studyData.currentDate !== today) {
                console.log('ğŸ“… æ–°çš„ä¸€å¤©å¼€å§‹');
                
                // ä¿å­˜å‰ä¸€å¤©çš„å†å²è®°å½•
                if (studyData.daily.date && studyData.daily.sessions.length > 0) {
                    studyData.history.push({
                        date: studyData.daily.date,
                        sessions: [...studyData.daily.sessions],
                        totalTime: studyData.daily.totalTime,
                        completed: studyData.daily.completed.length
                    });
                    
                    // åªä¿ç•™æœ€è¿‘60å¤©çš„å†å²
                    if (studyData.history.length > 60) {
                        studyData.history.shift();
                    }
                }
                
                // æ£€æŸ¥è¿ç»­å­¦ä¹ 
                const yesterday = getYesterdayDate();
                if (studyData.overall.lastStudyDate === yesterday) {
                    studyData.overall.streakDays++;
                    
                    // æ£€æŸ¥è¿ç»­å­¦ä¹ æˆå°±
                    checkStreakAchievements();
                } else if (studyData.overall.lastStudyDate !== today) {
                    studyData.overall.streakDays = 1;
                }
                
                // æ›´æ–°æ—¥æœŸç›¸å…³æ•°æ®
                studyData.currentDate = today;
                studyData.overall.lastStudyDate = today;
                studyData.overall.totalDays++;
                
                // æ–°çš„ä¸€å¤©ï¼šä¸é‡ç½®è¿›åº¦ï¼Œåªæ›´æ–°æ—¥æœŸ
                studyData.daily.date = today;
                studyData.daily.startTime = Date.now();
                studyData.daily.sessions = []; // é‡ç½®ä»Šæ—¥ç»ƒä¹ è®°å½•
                
                // æ™ºèƒ½æ¨èä¸‹ä¸€ä¸ªæ¨¡å—
                studyData.currentModuleIndex = findRecommendedModule();
                
                // æ›´æ–°æ•™ç»ƒæ¶ˆæ¯
                updateCoachMessage('newDay');
                
                saveData();
            }
        }
        
        // ============================================
        // ç•Œé¢æ›´æ–°å‡½æ•°
        // ============================================
        
        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            updateStatusBar();
            updateProgressBar();
            updateModuleList();
            updateAnalyticsPanel();
            updateCoachMessage();
            
            // è‡ªåŠ¨ä¿å­˜
            saveData();
        }
        
        // æ›´æ–°çŠ¶æ€æ 
        function updateStatusBar() {
            document.getElementById('currentRound').textContent = studyData.currentRound;
            
            const completedCount = studyData.daily.completed.length;
            const totalCount = studyData.modules.length;
            document.getElementById('todayProgress').textContent = `${completedCount}/${totalCount}`;
            
            document.getElementById('totalQuestions').textContent = studyData.overall.totalQuestions;
            
            // è®¡ç®—åŠ æƒæ­£ç¡®ç‡
            const accuracy = studyData.overall.totalQuestions > 0 ? 
                ((studyData.overall.totalCorrect / studyData.overall.totalQuestions) * 100).toFixed(1) : 0;
            document.getElementById('accuracyRate').textContent = `${accuracy}%`;
            
            // å­¦ä¹ æ—¶é•¿
            const totalHours = (studyData.overall.totalTime / 60).toFixed(1);
            document.getElementById('studyTime').textContent = `${totalHours}h`;
        }
        
        // æ›´æ–°è¿›åº¦æ¡
        function updateProgressBar() {
            const completedCount = studyData.daily.completed.length;
            const totalCount = studyData.modules.length;
            const progressPercent = totalCount > 0 ? (completedCount / totalCount * 100) : 0;
            
            document.getElementById('completedCount').textContent = completedCount;
            document.getElementById('totalCount').textContent = totalCount;
            document.getElementById('progressPercent').textContent = `${Math.round(progressPercent)}%`;
            document.getElementById('progressBar').style.width = `${progressPercent}%`;
        }
        
        // æ›´æ–°æ¨¡å—åˆ—è¡¨
        function updateModuleList() {
            const container = document.getElementById('modulesContainer');
            container.innerHTML = '';
            
            // è·å–å½“å‰è¿‡æ»¤çŠ¶æ€
            const filter = document.querySelector('.filter-btn.active')?.getAttribute('onclick')?.match(/'([^']+)'/)?.[1] || 'all';
            
            studyData.modules.forEach((module, index) => {
                const stats = studyData.moduleStats[module.id] || {
                    attempts: 0,
                    totalQuestions: 0,
                    totalCorrect: 0,
                    history: []
                };
                
                const isCompleted = studyData.daily.completed.includes(module.id);
                const isRecommended = index === studyData.currentModuleIndex && !isCompleted;
                const accuracy = stats.attempts > 0 ? (stats.totalCorrect / stats.totalQuestions) * 100 : 0;
                const isWeak = stats.attempts > 0 && accuracy < 65;
                const progressTrend = calculateProgressTrend(module.id);
                
                // åº”ç”¨è¿‡æ»¤
                let showModule = true;
                switch(filter) {
                    case 'weak':
                        showModule = isWeak && !isCompleted;
                        break;
                    case 'recommended':
                        showModule = isRecommended;
                        break;
                    case 'completed':
                        showModule = isCompleted;
                        break;
                }
                
                if (!showModule) return;
                
                const moduleDiv = document.createElement('div');
                moduleDiv.className = `module-item ${isCompleted ? 'completed' : ''} ${isRecommended ? 'recommended' : ''} ${isWeak ? 'weak' : ''}`;
                
                // çŠ¶æ€æ–‡æœ¬
                let statusText = 'å¾…å®Œæˆ';
                let statusClass = 'pending';
                
                if (isCompleted) {
                    statusText = 'å·²å®Œæˆ';
                    statusClass = 'completed';
                } else if (isRecommended) {
                    statusText = 'â­ æ¨è';
                    statusClass = 'recommended';
                } else if (isWeak) {
                    statusText = 'âš ï¸ è–„å¼±';
                    statusClass = 'weak';
                }
                
                // è¶‹åŠ¿æŒ‡ç¤ºå™¨
                let trendIndicator = '';
                if (progressTrend) {
                    if (progressTrend.direction === 'up') {
                        trendIndicator = `<span class="badge badge-growth">â†‘${progressTrend.magnitude.toFixed(1)}%</span>`;
                    } else if (progressTrend.direction === 'down') {
                        trendIndicator = `<span class="badge badge-fire">â†“${progressTrend.magnitude.toFixed(1)}%</span>`;
                    }
                }
                
                // æ„å»ºæ¨¡å—HTML
                moduleDiv.innerHTML = `
                    <div class="module-number">${index + 1}</div>
                    <div class="module-content">
                        <div class="module-header">
                            <div class="module-title">${module.name} ${trendIndicator}</div>
                            <div class="module-status ${statusClass}">${statusText}</div>
                        </div>
                        <div class="module-meta">
                            <span class="module-meta-item">ğŸ“ ${module.questions}é¢˜</span>
                            <span class="module-meta-item">â±ï¸ ${module.time}åˆ†é’Ÿ</span>
                            <span class="module-meta-item">ğŸ·ï¸ ${module.category}</span>
                        </div>
                        
                        ${stats.attempts > 0 ? `
                            <div class="module-stats">
                                <div class="stat-badge ${accuracy < 65 ? 'highlight' : ''}">
                                    <span>âœ…</span>
                                    æ­£ç¡®ç‡ï¼š${accuracy.toFixed(1)}%
                                </div>
                                <div class="stat-badge">
                                    <span>ğŸ“Š</span>
                                    ç»ƒä¹ ï¼š${stats.attempts}æ¬¡
                                </div>
                                <div class="stat-badge">
                                    <span>ğŸ“</span>
                                    å¹³å‡ï¼š${stats.avgQuestions ? stats.avgQuestions.toFixed(0) : module.questions}é¢˜/æ¬¡
                                </div>
                            </div>
                            
                            ${progressTrend ? `
                                <div class="module-insights">
                                    ${progressTrend.direction === 'up' ? 'ğŸ“ˆ æœ€è¿‘è¿›æ­¥æ˜æ˜¾ï¼Œç»§ç»­ä¿æŒï¼' : 
                                      progressTrend.direction === 'down' ? 'ğŸ“‰ æœ€è¿‘æœ‰æ‰€ä¸‹æ»‘ï¼Œéœ€è¦å…³æ³¨ï¼' : 
                                      'â¡ï¸ è¡¨ç°ç¨³å®šï¼Œç»§ç»­å·©å›ºï¼'}
                                </div>
                            ` : ''}
                        ` : `
                            <div class="module-insights">
                                ğŸ” æ–°æ¨¡å—ï¼Œå»ºè®®å…ˆå®Œæˆä¸€æ¬¡ç»ƒä¹ å»ºç«‹åŸºå‡†
                            </div>
                        `}
                        
                        ${!isCompleted ? `
                            <div class="module-actions">
                                <button class="btn btn-complete" onclick="completeModule(${index})" data-module-index="${index}">
                                    <span>âœ…</span>
                                    å¼€å§‹ç»ƒä¹ 
                                </button>
                                <button class="btn btn-details" onclick="showModuleDetails(${index})">
                                    <span>ğŸ“Š</span>
                                    è¯¦æƒ…
                                </button>
                            </div>
                        ` : ''}
                    </div>
                `;
                
                container.appendChild(moduleDiv);
            });
            
            // å¦‚æœæ²¡æœ‰æ¨¡å—æ˜¾ç¤º
            if (container.children.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #a0aec0;">
                        <div style="font-size: 48px; margin-bottom: 20px;">ğŸ“­</div>
                        <div style="font-size: 16px; margin-bottom: 10px;">æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ¨¡å—</div>
                        <div style="font-size: 14px; color: #cbd5e0;">è¯•è¯•åˆ‡æ¢ç­›é€‰æ¡ä»¶æˆ–é‡ç½®ç­›é€‰</div>
                    </div>
                `;
            }
        }
        
        // è¿‡æ»¤æ¨¡å—
        function filterModules(filterType) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // æ›´æ–°æ¨¡å—åˆ—è¡¨
            updateModuleList();
        }
        
        // æ›´æ–°åˆ†æé¢æ¿
        function updateAnalyticsPanel() {
            // ä»ªè¡¨ç›˜æ•°æ®
            document.getElementById('statTotalRounds').textContent = studyData.totalRounds;
            document.getElementById('statStreakDays').textContent = studyData.overall.streakDays;
            
            const avgAccuracy = studyData.overall.totalQuestions > 0 ? 
                (studyData.overall.totalCorrect / studyData.overall.totalQuestions * 100).toFixed(1) : 0;
            document.getElementById('statAvgAccuracy').textContent = `${avgAccuracy}%`;
            
            const avgQuestions = studyData.overall.totalSessions > 0 ? 
                Math.round(studyData.overall.totalQuestions / studyData.overall.totalSessions) : 0;
            document.getElementById('statAvgQuestions').textContent = avgQuestions;
            
            // è–„å¼±æ¨¡å—åˆ—è¡¨
            updateWeakModulesList();
            
            // ä»Šæ—¥å»ºè®®
            updateDailyTips();
        }
        
        // æ›´æ–°è–„å¼±æ¨¡å—åˆ—è¡¨
        function updateWeakModulesList() {
            const container = document.getElementById('weakModulesList');
            container.innerHTML = '';
            
            // æ‰¾å‡ºæ­£ç¡®ç‡ä½äº65%çš„æ¨¡å—
            const weakModules = studyData.modules
                .map(module => {
                    const stats = studyData.moduleStats[module.id];
                    if (!stats || stats.attempts === 0) return null;
                    
                    const accuracy = (stats.totalCorrect / stats.totalQuestions) * 100;
                    if (accuracy < 65) {
                        return {
                            module: module,
                            accuracy: accuracy,
                            attempts: stats.attempts
                        };
                    }
                    return null;
                })
                .filter(item => item !== null)
                .sort((a, b) => a.accuracy - b.accuracy) // æŒ‰æ­£ç¡®ç‡ä»ä½åˆ°é«˜æ’åº
                .slice(0, 5); // æœ€å¤šæ˜¾ç¤º5ä¸ª
            
            if (weakModules.length === 0) {
                container.innerHTML = `
                    <li class="weak-module-item">
                        <div class="weak-module-name">ğŸ‰ æš‚æ— è–„å¼±æ¨¡å—</div>
                        <div class="weak-module-accuracy">ç»§ç»­ä¿æŒï¼</div>
                    </li>
                `;
                return;
            }
            
            weakModules.forEach(item => {
                const li = document.createElement('li');
                li.className = 'weak-module-item';
                
                let accuracyClass = 'accuracy-low';
                let accuracyText = 'éœ€é‡ç‚¹çªç ´';
                
                if (item.accuracy < 50) {
                    accuracyText = 'ä¸¥é‡è–„å¼±';
                } else if (item.accuracy < 60) {
                    accuracyText = 'æ¯”è¾ƒè–„å¼±';
                } else {
                    accuracyText = 'éœ€è¦åŠ å¼º';
                }
                
                li.innerHTML = `
                    <div class="weak-module-name">${item.module.name}</div>
                    <div>
                        <span class="weak-module-accuracy">${item.accuracy.toFixed(1)}%</span>
                        <span class="accuracy-badge ${accuracyClass}">${accuracyText}</span>
                    </div>
                `;
                container.appendChild(li);
            });
        }
        
        // æ›´æ–°ä»Šæ—¥å»ºè®®
        function updateDailyTips() {
            const container = document.getElementById('dailyTips');
            const tips = [];
            
            // 1. æ£€æŸ¥è–„å¼±æ¨¡å—
            const weakModules = studyData.modules.filter(module => {
                const stats = studyData.moduleStats[module.id];
                if (!stats || stats.attempts === 0) return false;
                const accuracy = (stats.totalCorrect / stats.totalQuestions) * 100;
                return accuracy < 65;
            });
            
            if (weakModules.length > 0) {
                tips.push({
                    icon: 'âš ï¸',
                    text: `å‘ç°${weakModules.length}ä¸ªè–„å¼±æ¨¡å—ï¼Œå»ºè®®ä»Šå¤©é‡ç‚¹ç»ƒä¹ `
                });
            }
            
            // 2. æ£€æŸ¥è¿ç»­å­¦ä¹ 
            if (studyData.overall.streakDays >= 7) {
                tips.push({
                    icon: 'ğŸ”¥',
                    text: `å·²è¿ç»­å­¦ä¹ ${studyData.overall.streakDays}å¤©ï¼Œç»§ç»­ä¿æŒï¼`
                });
            }
            
            // 3. æ£€æŸ¥ç»ƒä¹ é¢‘ç‡
            const today = new Date().toISOString().split('T')[0];
            const todaySessions = studyData.daily.sessions.length;
            
            if (todaySessions === 0) {
                tips.push({
                    icon: 'ğŸ¯',
                    text: 'ä»Šå¤©å°šæœªå¼€å§‹å­¦ä¹ ï¼Œå»ºè®®è‡³å°‘å®Œæˆ1ä¸ªæ¨¡å—'
                });
            } else if (todaySessions < 3) {
                tips.push({
                    icon: 'âš¡',
                    text: `ä»Šå¤©å·²å®Œæˆ${todaySessions}æ¬¡ç»ƒä¹ ï¼Œå»ºè®®å†å®Œæˆ${3 - todaySessions}ä¸ªæ¨¡å—`
                });
            }
            
            // 4. æ£€æŸ¥å¹³å‡æ­£ç¡®ç‡
            const avgAccuracy = studyData.overall.totalQuestions > 0 ? 
                (studyData.overall.totalCorrect / studyData.overall.totalQuestions * 100) : 0;
            
            if (avgAccuracy > 80) {
                tips.push({
                    icon: 'ğŸ’',
                    text: `å½“å‰å¹³å‡æ­£ç¡®ç‡${avgAccuracy.toFixed(1)}%ï¼Œè¡¨ç°ä¼˜ç§€ï¼`
                });
            } else if (avgAccuracy < 70) {
                tips.push({
                    icon: 'ğŸ“‰',
                    text: `å½“å‰å¹³å‡æ­£ç¡®ç‡${avgAccuracy.toFixed(1)}%ï¼Œå»ºè®®æ³¨é‡ç»ƒä¹ è´¨é‡`
                });
            }
            
            // å¦‚æœæ²¡æœ‰å»ºè®®ï¼Œæ˜¾ç¤ºé»˜è®¤æç¤º
            if (tips.length === 0) {
                tips.push(
                    { icon: 'ğŸ¯', text: 'ç³»ç»Ÿä¼šæ ¹æ®ä½ çš„å†å²è¡¨ç°æ™ºèƒ½æ¨èç»ƒä¹ æ¨¡å—' },
                    { icon: 'ğŸ“', text: 'è–„å¼±æ¨¡å—ä¼šè‡ªåŠ¨å»ºè®®å¢åŠ é¢˜é‡ï¼Œå»ºè®®é‡ç‚¹çªç ´' },
                    { icon: 'âš¡', text: 'å¯ä»¥è‡ªç”±é€‰æ‹©ä»»æ„æ¨¡å—ç»ƒä¹ ï¼Œä¸å†å—é¡ºåºé™åˆ¶' }
                );
            }
            
            // æ›´æ–°DOM
            container.innerHTML = '';
            tips.forEach(tip => {
                const tipDiv = document.createElement('div');
                tipDiv.className = 'tip-item';
                tipDiv.innerHTML = `
                    <div class="tip-icon">${tip.icon}</div>
                    <div>${tip.text}</div>
                `;
                container.appendChild(tipDiv);
            });
        }
        
        // æ›´æ–°æ•™ç»ƒæ¶ˆæ¯
        function updateCoachMessage(type = 'greeting') {
            const container = document.getElementById('coachMessage');
            let message = '';
            
            const hour = new Date().getHours();
            let timeOfDay = 'morning';
            if (hour >= 12 && hour < 18) timeOfDay = 'afternoon';
            if (hour >= 18) timeOfDay = 'evening';
            
            switch(type) {
                case 'newDay':
                    message = `æ–°çš„ä¸€å¤©å¼€å§‹ï¼å·²è¿ç»­å­¦ä¹ ${studyData.overall.streakDays}å¤©ï¼Œç»§ç»­ä¿æŒï¼`;
                    break;
                case 'progress':
                    const completedCount = studyData.daily.completed.length;
                    const totalCount = studyData.modules.length;
                    const percent = Math.round((completedCount / totalCount) * 100);
                    message = `å½“å‰è¿›åº¦${completedCount}/${totalCount} (${percent}%)ï¼Œç»§ç»­åŠ æ²¹ï¼`;
                    break;
                case 'achievement':
                    // è¿™é‡Œå¯ä»¥æ·»åŠ æˆå°±è§¦å‘æ—¶çš„æ¶ˆæ¯
                    break;
                default:
                    // éšæœºé€‰æ‹©é—®å€™è¯­
                    const greetings = coachMessages.greetings;
                    message = greetings[Math.floor(Math.random() * greetings.length)];
                    
                    // æ›¿æ¢å˜é‡
                    message = message.replace('{streakDays}', studyData.overall.streakDays);
            }
            
            container.textContent = message;
        }
        
        // ============================================
        // æ¨¡å—æ“ä½œå‡½æ•°
        // ============================================
        
        // å®Œæˆæ¨¡å—
        function completeModule(index) {
            const module = studyData.modules[index];
            currentModuleInfo = {
                index: index,
                module: module,
                stats: studyData.moduleStats[module.id] || {
                    attempts: 0,
                    totalQuestions: 0,
                    totalCorrect: 0,
                    history: []
                }
            };
            
            // æ™ºèƒ½å»ºè®®é¢˜æ•°
            const recommendedQuestions = recommendQuestionCount(module.id);
            
            // è®¾ç½®å¼¹çª—æ ‡é¢˜
            document.getElementById('completeModuleTitle').textContent = `å®Œæˆï¼š${module.name}`;
            document.getElementById('completeModuleSubtitle').textContent = module.desc;
            
            // è®¾ç½®æ™ºèƒ½å»ºè®®
            document.getElementById('recommendedQuestions').textContent = recommendedQuestions;
            document.getElementById('questionsRange').value = recommendedQuestions;
            document.getElementById('questionsSlider').value = recommendedQuestions;
            document.getElementById('questionsInput').value = recommendedQuestions;
            document.getElementById('currentQuestions').textContent = recommendedQuestions;
            
            // è®¾ç½®é”™é¢˜æ•°èŒƒå›´ï¼ˆåŸºäºå»ºè®®é¢˜æ•°ï¼‰
            const wrongMax = Math.min(50, Math.floor(recommendedQuestions * 1.5));
            document.getElementById('wrongRange').max = wrongMax;
            document.getElementById('wrongInput').max = wrongMax;
            
            // é‡ç½®é”™é¢˜æ•°ä¸º0
            document.getElementById('wrongRange').value = 0;
            document.getElementById('wrongInput').value = 0;
            document.getElementById('wrongCountDisplay').textContent = '0';
            
            // æ›´æ–°å®æ—¶åé¦ˆ
            updateRealTimeFeedback();
            
            // æ˜¾ç¤ºå¼¹çª—
            document.getElementById('completeModal').style.display = 'flex';
            document.getElementById('questionsInput').focus();
            
            // è®°å½•å¼€å§‹æ—¶é—´
            currentModuleInfo.startTime = Date.now();
        }
        
        // æ›´æ–°å®æ—¶åé¦ˆ
        function updateRealTimeFeedback() {
            if (!currentModuleInfo) return;
            
            const practiceQuestions = parseInt(document.getElementById('questionsInput').value) || 20;
            const wrongCount = parseInt(document.getElementById('wrongInput').value) || 0;
            
            // è®¡ç®—æœ¬æ¬¡æ­£ç¡®ç‡
            const correctCount = Math.max(0, practiceQuestions - wrongCount);
            const accuracy = practiceQuestions > 0 ? (correctCount / practiceQuestions * 100).toFixed(1) : 0;
            
            // è®¡ç®—å†å²å¹³å‡
            const stats = currentModuleInfo.stats;
            const historyAccuracy = stats.attempts > 0 ? 
                (stats.totalCorrect / stats.totalQuestions * 100).toFixed(1) : 0;
            
            // è®¡ç®—è¿›æ­¥æƒ…å†µ
            let progressText = '-';
            if (stats.history.length > 0) {
                const lastAccuracy = stats.history[stats.history.length - 1].accuracy;
                const progress = accuracy - lastAccuracy;
                if (Math.abs(progress) > 0.1) {
                    progressText = `${progress > 0 ? '+' : ''}${progress.toFixed(1)}%`;
                }
            }
            
            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('accuracyDisplay').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsDisplay').textContent = stats.totalQuestions + practiceQuestions;
            document.getElementById('avgAccuracyDisplay').textContent = `${historyAccuracy}%`;
            document.getElementById('progressDisplay').textContent = progressText;
            
            // æ›´æ–°å½“å‰é¢˜æ•°æ˜¾ç¤º
            document.getElementById('currentQuestions').textContent = practiceQuestions;
            document.getElementById('wrongCountDisplay').textContent = wrongCount;
        }
        
        // æäº¤å®Œæˆ
        function submitComplete() {
            if (!currentModuleInfo) return;
            
            const practiceQuestions = parseInt(document.getElementById('questionsInput').value);
            const wrongCount = parseInt(document.getElementById('wrongInput').value);
            const note = document.getElementById('noteInput').value.trim();
            
            // éªŒè¯è¾“å…¥
            if (isNaN(practiceQuestions) || practiceQuestions < 1) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ç»ƒä¹ é¢˜æ•°ï¼');
                return;
            }
            
            if (isNaN(wrongCount) || wrongCount < 0 || wrongCount > practiceQuestions) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é”™é¢˜æ•°ï¼');
                return;
            }
            
            const module = currentModuleInfo.module;
            const stats = currentModuleInfo.stats;
            
            // è®¡ç®—æœ¬æ¬¡ç»ƒä¹ æ•°æ®
            const correctCount = practiceQuestions - wrongCount;
            const accuracy = (correctCount / practiceQuestions) * 100;
            const practiceTime = currentModuleInfo.startTime ? Math.round((Date.now() - currentModuleInfo.startTime) / 60000) : module.time;
            
            // æ›´æ–°æ¨¡å—ç»Ÿè®¡
            stats.attempts++;
            stats.totalQuestions += practiceQuestions;
            stats.totalCorrect += correctCount;
            stats.lastAccuracy = stats.bestAccuracy;
            stats.bestAccuracy = Math.max(stats.bestAccuracy, accuracy);
            stats.lastPracticeDate = new Date().toISOString();
            stats.avgQuestions = stats.totalQuestions / stats.attempts;
            
            // è®°å½•å†å²
            stats.history.push({
                date: studyData.currentDate,
                timestamp: Date.now(),
                practiceQuestions: practiceQuestions,
                wrongCount: wrongCount,
                accuracy: accuracy,
                note: note,
                timeSpent: practiceTime
            });
            
            // æ›´æ–°æ€»ä½“æ•°æ®
            studyData.overall.totalQuestions += practiceQuestions;
            studyData.overall.totalCorrect += correctCount;
            studyData.overall.totalTime += practiceTime;
            studyData.overall.totalSessions++;
            studyData.overall.avgQuestionsPerSession = studyData.overall.totalQuestions / studyData.overall.totalSessions;
            
            // æ›´æ–°ä»Šæ—¥æ•°æ®
            if (!studyData.daily.completed.includes(module.id)) {
                studyData.daily.completed.push(module.id);
                studyData.todayCompleted++;
            }
            
            studyData.daily.totalTime += practiceTime;
            studyData.daily.sessions.push({
                moduleId: module.id,
                moduleName: module.name,
                practiceQuestions: practiceQuestions,
                wrongCount: wrongCount,
                accuracy: accuracy,
                timeSpent: practiceTime,
                timestamp: Date.now()
            });
            
            // æ£€æŸ¥æˆå°±
            checkAchievements();
            
            // æ•™ç»ƒåé¦ˆ
            let coachMessage = '';
            if (accuracy >= 90) {
                coachMessage = `ğŸ’ å®Œç¾ï¼${module.name}æ­£ç¡®ç‡${accuracy.toFixed(1)}%ï¼Œå¤ªå¼ºäº†ï¼`;
            } else if (accuracy >= 80) {
                coachMessage = `âœ… ä¼˜ç§€ï¼${module.name}å®Œæˆï¼Œæ­£ç¡®ç‡${accuracy.toFixed(1)}%`;
            } else if (accuracy >= 70) {
                coachMessage = `ğŸ‘ ä¸é”™ï¼${module.name}æ­£ç¡®ç‡${accuracy.toFixed(1)}%ï¼Œç»§ç»­åŠ æ²¹ï¼`;
            } else {
                coachMessage = `ğŸ“ ${module.name}å®Œæˆï¼Œæ­£ç¡®ç‡${accuracy.toFixed(1)}%ï¼Œéœ€è¦åŠ å¼ºç»ƒä¹ ï¼`;
            }
            
            updateCoachMessage();
            showNotification("ç»ƒä¹ å®Œæˆ", coachMessage, accuracy >= 80 ? "success" : "info");
            
            // æ£€æŸ¥æ˜¯å¦å®Œæˆä¸€è½®
            if (studyData.daily.completed.length >= studyData.modules.length) {
                // å®Œæˆä¸€è½®ï¼
                studyData.currentRound++;
                studyData.totalRounds++;
                
                // é‡ç½®æ‰€æœ‰æ¨¡å—ï¼Œå¼€å§‹æ–°ä¸€è½®
                studyData.daily.completed = [];
                studyData.currentModuleIndex = findRecommendedModule();
                studyData.todayCompleted = 0;
                studyData.daily.totalTime = 0;
                studyData.daily.sessions = [];
                
                showNotification("ğŸ‰ æ­å–œï¼", `å®Œæˆç¬¬${studyData.currentRound-1}è½®å­¦ä¹ ï¼Œå¼€å§‹ç¬¬${studyData.currentRound}è½®ï¼`, "success");
                updateCoachMessage('newRound');
            } else {
                // æ™ºèƒ½æ¨èä¸‹ä¸€ä¸ªæ¨¡å—
                studyData.currentModuleIndex = findRecommendedModule();
            }
            
            closeCompleteModal();
            updateDisplay();
            
            // é‡ç½®å½“å‰æ¨¡å—ä¿¡æ¯
            currentModuleInfo = null;
        }
        
        // ============================================
        // æˆå°±ç³»ç»Ÿ
        // ============================================
        
        function checkAchievements() {
            const newAchievements = [];
            
            // æ£€æŸ¥æ€»é¢˜æ•°æˆå°±
            studyData.achievements.totalQuestionsMilestones.forEach(milestone => {
                if (studyData.overall.totalQuestions >= milestone && 
                    !studyData.achievements.completed.includes(`questions_${milestone}`)) {
                    newAchievements.push({
                        type: 'questions',
                        milestone: milestone,
                        message: `ğŸ‰ å®Œæˆ${milestone}é¢˜é‡Œç¨‹ç¢‘ï¼`
                    });
                    studyData.achievements.completed.push(`questions_${milestone}`);
                }
            });
            
            // æ£€æŸ¥è¿ç»­å­¦ä¹ æˆå°±
            studyData.achievements.streakMilestones.forEach(milestone => {
                if (studyData.overall.streakDays >= milestone && 
                    !studyData.achievements.completed.includes(`streak_${milestone}`)) {
                    newAchievements.push({
                        type: 'streak',
                        milestone: milestone,
                        message: `ğŸ”¥ è¿ç»­å­¦ä¹ ${milestone}å¤©æˆå°±è¾¾æˆï¼`
                    });
                    studyData.achievements.completed.push(`streak_${milestone}`);
                }
            });
            
            // æ˜¾ç¤ºæ–°æˆå°±
            newAchievements.forEach(achievement => {
                setTimeout(() => {
                    showNotification("ğŸ–ï¸ æ–°æˆå°±è¾¾æˆ", achievement.message, "success");
                }, 500);
            });
        }
        
        function checkStreakAchievements() {
            studyData.achievements.streakMilestones.forEach(milestone => {
                if (studyData.overall.streakDays === milestone && 
                    !studyData.achievements.completed.includes(`streak_${milestone}`)) {
                    showNotification("ğŸ–ï¸ æ–°æˆå°±è¾¾æˆ", `ğŸ”¥ è¿ç»­å­¦ä¹ ${milestone}å¤©ï¼`, "success");
                    studyData.achievements.completed.push(`streak_${milestone}`);
                }
            });
        }
        
        // ============================================
        // å¼¹çª—æ§åˆ¶å‡½æ•°
        // ============================================
        
        function closeCompleteModal() {
            document.getElementById('completeModal').style.display = 'none';
            document.getElementById('noteInput').value = '';
            currentModuleInfo = null;
        }
        
        function showStatsModal() {
            generateStatsReport();
            document.getElementById('statsModal').style.display = 'flex';
        }
        
        function closeStatsModal() {
            document.getElementById('statsModal').style.display = 'none';
        }
        
        function showEditModal() {
            updateModuleEditList();
            document.getElementById('editModal').style.display = 'flex';
        }
        
        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
        }
        
        function showAddModuleModal() {
            document.getElementById('newModuleName').value = '';
            document.getElementById('newModuleTime').value = 30;
            document.getElementById('newModuleQuestions').value = 20;
            document.getElementById('newModuleDesc').value = '';
            
            document.getElementById('editModal').style.display = 'none';
            document.getElementById('addModuleModal').style.display = 'flex';
            document.getElementById('newModuleName').focus();
        }
        
        function closeAddModuleModal() {
            document.getElementById('addModuleModal').style.display = 'none';
            showEditModal();
        }
        
        function showResetModal() {
            document.getElementById('resetModal').style.display = 'flex';
        }
        
        function closeResetModal() {
            document.getElementById('resetModal').style.display = 'none';
        }
        
        function showClearAllModal() {
            document.getElementById('resetConfirmInput').value = '';
            document.getElementById('clearAllBtn').disabled = true;
            document.getElementById('clearAllModal').style.display = 'flex';
        }
        
        function closeClearAllModal() {
            document.getElementById('clearAllModal').style.display = 'none';
        }
        
        // ============================================
        // æ•°æ®ç®¡ç†å‡½æ•°
        // ============================================
        
        function resetToday() {
            if (!confirm('ç¡®å®šé‡ç½®å½“å‰è½®æ¬¡è¿›åº¦å—ï¼Ÿæ‰€æœ‰å·²å®Œæˆçš„æ¨¡å—å°†è¢«æ ‡è®°ä¸ºæœªå®Œæˆï¼Œæœ¬è½®é‡æ–°å¼€å§‹ã€‚')) return;
            
            studyData.todayCompleted = 0;
            studyData.currentModuleIndex = findRecommendedModule();
            studyData.daily.completed = [];
            studyData.daily.totalTime = 0;
            studyData.daily.sessions = [];
            
            closeResetModal();
            updateDisplay();
            
            showNotification("é‡ç½®å®Œæˆ", "å½“å‰è½®æ¬¡å·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°å¼€å§‹å­¦ä¹ ", "info");
            updateCoachMessage('reset');
        }
        
        function clearAllData() {
            if (!confirm('æœ€åç¡®è®¤ï¼šè¿™å°†æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼Œæ— æ³•æ¢å¤ï¼')) return;
            
            // æ¸…ç©ºæ‰€æœ‰æ•°æ®
            studyData.currentDate = getTodayDate();
            studyData.currentRound = 1;
            studyData.currentModuleIndex = 0;
            studyData.todayCompleted = 0;
            studyData.totalRounds = 0;
            
            studyData.overall = {
                totalQuestions: 0,
                totalCorrect: 0,
                streakDays: 1,
                totalDays: 1,
                lastStudyDate: getTodayDate(),
                totalTime: 0,
                totalSessions: 0,
                avgQuestionsPerSession: 0
            };
            
            studyData.moduleStats = {};
            
            studyData.daily = {
                date: getTodayDate(),
                completed: [],
                startTime: Date.now(),
                totalTime: 0,
                sessions: []
            };
            
            studyData.history = [];
            studyData.achievements.completed = [];
            
            // é‡ç½®ä¸ºé»˜è®¤æ¨¡å—
            studyData.modules = [
                { id: 1, name: "è¨€è¯­ç‰‡æ®µé˜…è¯»", category: "è¨€è¯­ç†è§£", time: 30, questions: 20, desc: "æ¯é¢˜â‰¤10å­—å†™æ ¸å¿ƒè®ºç‚¹", order: 1 },
                { id: 2, name: "é€»è¾‘åˆ¤æ–­", category: "åˆ¤æ–­æ¨ç†", time: 35, questions: 20, desc: "å†™è®ºè¯ç±»å‹+é€»è¾‘é“¾", order: 2 },
                { id: 3, name: "èµ„æ–™åˆ†æ", category: "èµ„æ–™åˆ†æ", time: 35, questions: 20, desc: "å£è¿°æœ€éš¾è®¡ç®—æ€è·¯", order: 3 },
                { id: 4, name: "è¨€è¯­å¡«ç©º", category: "è¨€è¯­ç†è§£", time: 30, questions: 20, desc: "è®°å½•çŠ¹è±«é€‰é¡¹å¹¶è¾¨æ", order: 4 },
                { id: 5, name: "å›¾å½¢æ¨ç†", category: "åˆ¤æ–­æ¨ç†", time: 25, questions: 20, desc: "æ³¨é”™/æ…¢é¢˜'æ­»åœ¨ä½•æ­¥'", order: 5 },
                { id: 6, name: "å®šä¹‰åˆ¤æ–­", category: "åˆ¤æ–­æ¨ç†", time: 25, questions: 20, desc: "å…ˆè‡ªè¯é‡è¿°å®šä¹‰", order: 6 },
                { id: 7, name: "ç±»æ¯”æ¨ç†", category: "åˆ¤æ–­æ¨ç†", time: 20, questions: 20, desc: "é”™é¢˜åå‘æ„é€ ä¾‹å­", order: 7 },
                { id: 8, name: "ç»ˆæä»»åŠ¡", category: "ç»¼åˆè®­ç»ƒ", time: 60, questions: 1, desc: "ç”³è®º/é”™æ€/ä½“èƒ½ä¸‰é€‰ä¸€", order: 8 }
            ];
            
            // åˆå§‹åŒ–é»˜è®¤æ¨¡å—çš„ç»Ÿè®¡
            studyData.modules.forEach(module => {
                studyData.moduleStats[module.id] = {
                    attempts: 0,
                    totalQuestions: 0,
                    totalCorrect: 0,
                    bestAccuracy: 0,
                    lastAccuracy: 0,
                    history: [],
                    lastPracticeDate: '',
                    streak: 0,
                    avgQuestions: module.questions
                };
            });
            
            closeClearAllModal();
            saveData();
            updateDisplay();
            
            showNotification("æ•°æ®å·²æ¸…ç©º", "æ‰€æœ‰å­¦ä¹ æ•°æ®å·²é‡ç½®ï¼Œé‡æ–°å¼€å§‹å­¦ä¹ ä¹‹æ—…", "info");
            updateCoachMessage('resetAll');
        }
        
        function exportData() {
            const dataStr = JSON.stringify(studyData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `å…¬è€ƒå­¦ä¹ æ•°æ®_${getTodayDate()}_v2.0.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            setTimeout(() => URL.revokeObjectURL(url), 100);
            
            showNotification("å¯¼å‡ºæˆåŠŸ", "å­¦ä¹ æ•°æ®å·²å¯¼å‡ºä¸ºJSONæ–‡ä»¶", "success");
        }
        
        // ============================================
        // äº‹ä»¶ç›‘å¬å™¨è®¾ç½®
        // ============================================
        
        function setupEventListeners() {
            // é¢˜æ•°æ»‘å—å’Œè¾“å…¥æ¡†åŒæ­¥
            const questionsSlider = document.getElementById('questionsSlider');
            const questionsInput = document.getElementById('questionsInput');
            const questionsRange = document.getElementById('questionsRange');
            
            if (questionsSlider && questionsInput) {
                questionsSlider.addEventListener('input', function() {
                    questionsInput.value = this.value;
                    updateRealTimeFeedback();
                });
                
                questionsInput.addEventListener('input', function() {
                    questionsSlider.value = this.value;
                    updateRealTimeFeedback();
                });
                
                questionsRange.addEventListener('input', function() {
                    const value = this.value;
                    questionsSlider.value = value;
                    questionsInput.value = value;
                    updateRealTimeFeedback();
                });
            }
            
            // é”™é¢˜æ•°æ»‘å—å’Œè¾“å…¥æ¡†åŒæ­¥
            const wrongRange = document.getElementById('wrongRange');
            const wrongInput = document.getElementById('wrongInput');
            
            if (wrongRange && wrongInput) {
                wrongRange.addEventListener('input', function() {
                    wrongInput.value = this.value;
                    updateRealTimeFeedback();
                });
                
                wrongInput.addEventListener('input', function() {
                    wrongRange.value = this.value;
                    updateRealTimeFeedback();
                });
            }
            
            // æ¸…ç©ºæ•°æ®ç¡®è®¤è¾“å…¥
            const resetConfirmInput = document.getElementById('resetConfirmInput');
            const clearAllBtn = document.getElementById('clearAllBtn');
            
            if (resetConfirmInput && clearAllBtn) {
                resetConfirmInput.addEventListener('input', function() {
                    clearAllBtn.disabled = this.value.toUpperCase() !== 'DELETE';
                });
            }
            
            // è‡ªåŠ¨æ›´æ–°æ•™ç»ƒæ¶ˆæ¯ï¼ˆæ¯30åˆ†é’Ÿï¼‰
            setInterval(() => {
                updateCoachMessage();
            }, 30 * 60 * 1000);
            
            // æ£€æŸ¥é•¿æ—¶é—´æ— æ“ä½œï¼ˆæ¯10åˆ†é’Ÿï¼‰
            let lastActivity = Date.now();
            const activityEvents = ['click', 'touchstart', 'keydown', 'mousemove', 'scroll'];
            
            activityEvents.forEach(event => {
                document.addEventListener(event, () => {
                    lastActivity = Date.now();
                });
            });
            
            setInterval(() => {
                if (Date.now() - lastActivity > 30 * 60 * 1000) {
                    const completedCount = studyData.daily.completed.length;
                    if (completedCount < studyData.modules.length) {
                        showNotification("â° å­¦ä¹ æé†’", "æ£€æµ‹åˆ°é•¿æ—¶é—´æ— æ“ä½œï¼Œå¿«å›æ¥ç»§ç»­å­¦ä¹ å§ï¼", "warning");
                        lastActivity = Date.now();
                    }
                }
            }, 10 * 60 * 1000);
        }
        
        // ============================================
        // å…¶ä»–åŠŸèƒ½å‡½æ•°
        // ============================================
        
        function updateModuleEditList() {
            const container = document.getElementById('moduleEditList');
            container.innerHTML = '';
            
            studyData.modules.forEach((module, index) => {
                const div = document.createElement('div');
                div.className = 'module-edit-item';
                div.innerHTML = `
                    <div>
                        <div style="font-weight: 600; margin-bottom: 5px;">${module.name}</div>
                        <div style="font-size: 12px; color: #718096;">
                            ${module.category} Â· ${module.questions}é¢˜ Â· ${module.time}åˆ†é’Ÿ
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button onclick="moveModule(${index}, -1)" ${index === 0 ? 'disabled style="opacity:0.5; cursor:not-allowed;"' : ''} style="background: none; border: 1px solid #e2e8f0; border-radius: 6px; padding: 6px 10px; cursor: pointer;">
                            â¬†ï¸
                        </button>
                        <button onclick="moveModule(${index}, 1)" ${index === studyData.modules.length-1 ? 'disabled style="opacity:0.5; cursor:not-allowed;"' : ''} style="background: none; border: 1px solid #e2e8f0; border-radius: 6px; padding: 6px 10px; cursor: pointer;">
                            â¬‡ï¸
                        </button>
                        <button onclick="removeModule(${index})" style="background: none; border: 1px solid #fed7d7; color: #e53e3e; border-radius: 6px; padding: 6px 10px; cursor: pointer;">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function moveModule(index, direction) {
            const newIndex = index + direction;
            if (newIndex < 0 || newIndex >= studyData.modules.length) return;
            
            // äº¤æ¢ä½ç½®
            [studyData.modules[index], studyData.modules[newIndex]] = 
            [studyData.modules[newIndex], studyData.modules[index]];
            
            // æ›´æ–°order
            studyData.modules.forEach((module, i) => {
                module.order = i + 1;
            });
            
            updateModuleEditList();
            updateDisplay();
        }
        
        function removeModule(index) {
            if (!confirm(`ç¡®å®šåˆ é™¤æ¨¡å—"${studyData.modules[index].name}"å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`)) return;
            
            const moduleId = studyData.modules[index].id;
            
            // åˆ é™¤æ¨¡å—ç»Ÿè®¡æ•°æ®
            delete studyData.moduleStats[moduleId];
            
            // åˆ é™¤æ¨¡å—
            studyData.modules.splice(index, 1);
            
            // æ›´æ–°order
            studyData.modules.forEach((module, i) => {
                module.order = i + 1;
            });
            
            // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰æ¨¡å—ï¼Œéœ€è¦è°ƒæ•´currentModuleIndex
            if (index <= studyData.currentModuleIndex) {
                studyData.currentModuleIndex = Math.max(0, studyData.currentModuleIndex - 1);
            }
            
            updateModuleEditList();
            updateDisplay();
            
            showNotification("æ¨¡å—å·²åˆ é™¤", "å­¦ä¹ æ¨¡å—å·²ä»åˆ—è¡¨ä¸­ç§»é™¤", "info");
        }
        
        function addModule() {
            const name = document.getElementById('newModuleName').value.trim();
            const category = document.getElementById('newModuleCategory').value;
            const time = parseInt(document.getElementById('newModuleTime').value);
            const questions = parseInt(document.getElementById('newModuleQuestions').value);
            const desc = document.getElementById('newModuleDesc').value.trim();
            
            if (!name) {
                alert('è¯·è¾“å…¥æ¨¡å—åç§°ï¼');
                return;
            }
            
            if (isNaN(time) || time < 5) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ—¶é—´ï¼ˆè‡³å°‘5åˆ†é’Ÿï¼‰ï¼');
                return;
            }
            
            if (isNaN(questions) || questions < 1) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é¢˜é‡ï¼');
                return;
            }
            
            const newModule = {
                id: Date.now(),
                name: name,
                category: category,
                time: time,
                questions: questions,
                desc: desc || "è¯·æŒ‰è¦æ±‚å®Œæˆç»ƒä¹ ",
                order: studyData.modules.length + 1
            };
            
            studyData.modules.push(newModule);
            
            // åˆå§‹åŒ–ç»Ÿè®¡
            studyData.moduleStats[newModule.id] = {
                attempts: 0,
                totalQuestions: 0,
                totalCorrect: 0,
                bestAccuracy: 0,
                lastAccuracy: 0,
                history: [],
                lastPracticeDate: '',
                streak: 0,
                avgQuestions: questions
            };
            
            closeAddModuleModal();
            showEditModal();
            
            showNotification("æ¨¡å—å·²æ·»åŠ ", `æ–°æ¨¡å—"${name}"å·²æ·»åŠ åˆ°å­¦ä¹ åˆ—è¡¨`, "success");
        }
        
        function saveModules() {
            saveData();
            closeEditModal();
            updateDisplay();
            
            showNotification("è®¾ç½®å·²ä¿å­˜", "æ¨¡å—ç®¡ç†è®¾ç½®å·²æ›´æ–°", "success");
        }
        
        function generateStatsReport() {
            const container = document.getElementById('statsContent');
            
            // è®¡ç®—ç»Ÿè®¡æ•°æ®
            const totalModules = studyData.modules.length;
            const completedToday = studyData.daily.completed.length;
            const totalQuestions = studyData.overall.totalQuestions;
            const totalCorrect = studyData.overall.totalCorrect;
            const overallAccuracy = totalQuestions > 0 ? (totalCorrect / totalQuestions * 100).toFixed(1) : 0;
            const totalTime = formatTime(studyData.overall.totalTime);
            const avgQuestionsPerSession = studyData.overall.avgQuestionsPerSession.toFixed(1);
            
            // æ‰¾å‡ºæœ€ä½³å’Œæœ€å·®æ¨¡å—
            let bestModule = null;
            let worstModule = null;
            let bestAccuracy = 0;
            let worstAccuracy = 100;
            
            studyData.modules.forEach(module => {
                const stats = studyData.moduleStats[module.id];
                if (stats && stats.attempts > 0) {
                    const accuracy = (stats.totalCorrect / stats.totalQuestions) * 100;
                    if (accuracy > bestAccuracy) {
                        bestAccuracy = accuracy;
                        bestModule = module;
                    }
                    if (accuracy < worstAccuracy) {
                        worstAccuracy = accuracy;
                        worstModule = module;
                    }
                }
            });
            
            // ç”ŸæˆæŠ¥å‘ŠHTML
            let reportHTML = `
                <div style="margin-bottom: 25px;">
                    <div style="font-size: 16px; font-weight: 600; color: #2d3748; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0;">ğŸ“Š å­¦ä¹ æ¦‚è§ˆ</div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <div style="background: #f7fafc; padding: 15px; border-radius: 10px;">
                            <div style="font-size: 14px; color: #718096; margin-bottom: 5px;">æ€»å­¦ä¹ è½®æ¬¡</div>
                            <div style="font-size: 24px; font-weight: 700; color: #2d3748;">${studyData.totalRounds}</div>
                        </div>
                        <div style="background: #f7fafc; padding: 15px; border-radius: 10px;">
                            <div style="font-size: 14px; color: #718096; margin-bottom: 5px;">è¿ç»­å­¦ä¹ å¤©æ•°</div>
                            <div style="font-size: 24px; font-weight: 700; color: #2d3748;">${studyData.overall.streakDays}</div>
                        </div>
                        <div style="background: #f7fafc; padding: 15px; border-radius: 10px;">
                            <div style="font-size: 14px; color: #718096; margin-bottom: 5px;">æ€»ç»ƒä¹ é¢˜æ•°</div>
                            <div style="font-size: 24px; font-weight: 700; color: #2d3748;">${totalQuestions}</div>
                        </div>
                        <div style="background: #f7fafc; padding: 15px; border-radius: 10px;">
                            <div style="font-size: 14px; color: #718096; margin-bottom: 5px;">å¹³å‡æ­£ç¡®ç‡</div>
                            <div style="font-size: 24px; font-weight: 700; color: #2d3748;">${overallAccuracy}%</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div style="font-size: 16px; font-weight: 600; color: #2d3748; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0;">ğŸ“ˆ æ¨¡å—è¡¨ç°åˆ†æ</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: #f0fff4; padding: 15px; border-radius: 10px; border-left: 4px solid #38a169;">
                            <div style="font-size: 14px; color: #276749; margin-bottom: 8px;">ğŸ† æœ€ä½³è¡¨ç°æ¨¡å—</div>
                            <div style="font-size: 18px; font-weight: 700; color: #276749; margin-bottom: 5px;">${bestModule ? bestModule.name : 'æš‚æ— æ•°æ®'}</div>
                            <div style="font-size: 14px; color: #2d3748;">æ­£ç¡®ç‡ï¼š${bestModule ? bestAccuracy.toFixed(1) : 0}%</div>
                        </div>
                        <div style="background: #fff5f5; padding: 15px; border-radius: 10px; border-left: 4px solid #e53e3e;">
                            <div style="font-size: 14px; color: #c53030; margin-bottom: 8px;">âš ï¸ æœ€éœ€æé«˜æ¨¡å—</div>
                            <div style="font-size: 18px; font-weight: 700; color: #c53030; margin-bottom: 5px;">${worstModule ? worstModule.name : 'æš‚æ— æ•°æ®'}</div>
                            <div style="font-size: 14px; color: #2d3748;">æ­£ç¡®ç‡ï¼š${worstModule ? worstAccuracy.toFixed(1) : 0}%</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div style="font-size: 16px; font-weight: 600; color: #2d3748; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0;">ğŸ¯ å­¦ä¹ æ•ˆç‡åˆ†æ</div>
                    <div style="background: #f7fafc; padding: 20px; border-radius: 10px;">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 15px;">
                            <div>
                                <div style="font-size: 14px; color: #718096; margin-bottom: 5px;">å¹³å‡æ¯æ¬¡ç»ƒä¹ æ—¶é•¿</div>
                                <div style="font-size: 18px; font-weight: 700; color: #2d3748;">${totalTime}</div>
                            </div>
                            <div>
                                <div style="font-size: 14px; color: #718096; margin-bottom: 5px;">å¹³å‡æ¯æ¬¡ç»ƒä¹ é¢˜æ•°</div>
                                <div style="font-size: 18px; font-weight: 700; color: #2d3748;">${avgQuestionsPerSession}é¢˜</div>
                            </div>
                        </div>
                        <div style="font-size: 14px; color: #4a5568; line-height: 1.6;">
                            ${studyData.overall.totalSessions > 0 ? 
                                `åŸºäº${studyData.overall.totalSessions}æ¬¡ç»ƒä¹ æ•°æ®åˆ†æï¼Œä½ çš„å­¦ä¹ æ•ˆç‡${overallAccuracy >= 75 ? 'è¾ƒé«˜' : 'æœ‰å¾…æé«˜'}ã€‚` : 
                                'ç»ƒä¹ æ•°æ®ä¸è¶³ï¼Œæ— æ³•è¿›è¡Œæ•ˆç‡åˆ†æã€‚'}
                        </div>
                    </div>
                </div>
                
                <div>
                    <div style="font-size: 16px; font-weight: 600; color: #2d3748; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0;">ğŸ’¡ ä¸ªæ€§åŒ–å»ºè®®</div>
                    <div style="background: #ebf8ff; padding: 20px; border-radius: 10px; border-left: 4px solid #4299e1;">
                        <div style="font-size: 14px; color: #2c5282; line-height: 1.6;">
                            ${generatePersonalizedAdvice()}
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = reportHTML;
        }
        
        function generatePersonalizedAdvice() {
            const advice = [];
            
            // åŸºäºè¿ç»­å­¦ä¹ å¤©æ•°çš„å»ºè®®
            if (studyData.overall.streakDays >= 7) {
                advice.push("âœ… ä½ å·²ä¿æŒè¿ç»­å­¦ä¹ è¶…è¿‡ä¸€å‘¨ï¼Œå­¦ä¹ ä¹ æƒ¯è‰¯å¥½ï¼");
            } else if (studyData.overall.streakDays < 3) {
                advice.push("ğŸ“… å»ºè®®å»ºç«‹æ›´ç¨³å®šçš„å­¦ä¹ èŠ‚å¥ï¼Œè¿ç»­å­¦ä¹ æ•ˆæœæ›´ä½³ã€‚");
            }
            
            // åŸºäºæ­£ç¡®ç‡çš„å»ºè®®
            const overallAccuracy = studyData.overall.totalQuestions > 0 ? 
                (studyData.overall.totalCorrect / studyData.overall.totalQuestions * 100) : 0;
            
            if (overallAccuracy >= 80) {
                advice.push("ğŸ’ æ•´ä½“æ­£ç¡®ç‡ä¼˜ç§€ï¼Œå¯ä»¥é€‚å½“æŒ‘æˆ˜æ›´é«˜éš¾åº¦çš„ç»ƒä¹ ã€‚");
            } else if (overallAccuracy >= 70) {
                advice.push("ğŸ‘ æ­£ç¡®ç‡è‰¯å¥½ï¼Œå»ºè®®åœ¨ä¿æŒçš„åŸºç¡€ä¸Šå¯»æ±‚çªç ´ã€‚");
            } else if (overallAccuracy >= 60) {
                advice.push("ğŸ“ æ­£ç¡®ç‡æœ‰æå‡ç©ºé—´ï¼Œå»ºè®®åŠ å¼ºé”™é¢˜åˆ†æå’Œè–„å¼±æ¨¡å—ç»ƒä¹ ã€‚");
            } else {
                advice.push("âš ï¸ æ­£ç¡®ç‡åä½ï¼Œå»ºè®®æ”¾æ…¢èŠ‚å¥ï¼Œæ³¨é‡ç»ƒä¹ è´¨é‡è€Œéæ•°é‡ã€‚");
            }
            
            // åŸºäºç»ƒä¹ é¢‘ç‡çš„å»ºè®®
            const today = new Date().toISOString().split('T')[0];
            const todaySessions = studyData.daily.sessions.length;
            
            if (todaySessions === 0) {
                advice.push("ğŸ¯ ä»Šå¤©å°šæœªå¼€å§‹å­¦ä¹ ï¼Œå»ºè®®å°½å¿«å®Œæˆè‡³å°‘1ä¸ªæ¨¡å—çš„ç»ƒä¹ ã€‚");
            } else if (todaySessions >= 3) {
                advice.push("âš¡ ä»Šå¤©ç»ƒä¹ é‡å……è¶³ï¼Œæ³¨æ„é€‚å½“ä¼‘æ¯ï¼Œé¿å…è¿‡åº¦ç–²åŠ³ã€‚");
            }
            
            // åŸºäºè–„å¼±æ¨¡å—çš„å»ºè®®
            const weakModules = studyData.modules.filter(module => {
                const stats = studyData.moduleStats[module.id];
                if (!stats || stats.attempts === 0) return false;
                const accuracy = (stats.totalCorrect / stats.totalQuestions) * 100;
                return accuracy < 65;
            });
            
            if (weakModules.length > 0) {
                advice.push(`ğŸ“‰ å‘ç°${weakModules.length}ä¸ªè–„å¼±æ¨¡å—ï¼Œå»ºè®®åˆ¶å®šä¸“é¡¹çªç ´è®¡åˆ’ã€‚`);
            }
            
            return advice.length > 0 ? advice.join('<br><br>') : "ä¿æŒå½“å‰å­¦ä¹ èŠ‚å¥ï¼Œç³»ç»Ÿä¼šæŒç»­ä¸ºä½ æä¾›ä¸ªæ€§åŒ–å»ºè®®ã€‚";
        }
        
        // ============================================
        // é¡µé¢åŠ è½½
        // ============================================
        
        window.onload = init;
        
        // å…¨å±€äº‹ä»¶ç›‘å¬ï¼ˆç”¨äºå®æ—¶åé¦ˆæ›´æ–°ï¼‰
        document.addEventListener('input', function(e) {
            if (e.target.id === 'questionsInput' || e.target.id === 'questionsSlider' || 
                e.target.id === 'wrongInput' || e.target.id === 'wrongRange') {
                updateRealTimeFeedback();
            }
        });
    </script>
</body>
</html>
